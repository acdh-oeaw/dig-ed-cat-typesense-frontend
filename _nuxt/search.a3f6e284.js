import{T as fe,H as ve}from"./components.d97d9a12.js";import{o as _,c as m,a as u,_ as _e,v as le,f as T,r as w,t as k,g as a,F as A,k as V,x as se,y as me,z as E,d as D,b as y,w as j,A as F,j as R,B as he,C as ge,D as K,E as Q,n as W,G as ae,l as N,H as oe,h as ye,I as be,J as te}from"./entry.e6be0f91.js";import{k as we,a as xe,b as ke,r as $e,_ as je}from"./mapping-objects.38f7d757.js";import{c as Se}from"./centered.390d431c.js";import{_ as Oe}from"./nuxt-link.11c62d29.js";import"./_commonjsHelpers.042e6b4d.js";import"./asyncData.371759ea.js";function De(e,n){return _(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[u("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Ce(e,n){return _(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[u("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function q(e,n){return _(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[u("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ee={},Pe={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Te(e,n){return _(),m("div",Pe,[le(e.$slots,"default")])}const Be=_e(Ee,[["render",Te]]),He={class:"flex flex-col"},Ae={class:"flex items-center justify-between text-2xl"},Me={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ne=["id","value"],Ie=["for"],Le=T({__name:"facet-field",props:{facet:{},selected:{}},setup(e){const n=e;let s=w(n.selected),l=w(!1),t=w(n.facet);const d=async()=>{var o,c,r;l.value=!0;const i=await xe(t.value.field_name);t.value=(c=(o=i.value)==null?void 0:o.facet_counts)!=null&&c.length?(r=i.value)==null?void 0:r.facet_counts[0]:[],l.value=!1};return(i,o)=>{const c=Be;return _(),m("div",He,[u("h1",Ae,k(a(we)[a(t).field_name]),1),(_(!0),m(A,null,V(a(t).counts,r=>(_(),m("div",Me,[se(u("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer",id:r.value,value:r.value,onChange:o[0]||(o[0]=b=>i.$emit("facetChange",a(s))),"onUpdate:modelValue":o[1]||(o[1]=b=>E(s)?s.value=b:s=b)},null,40,Ne),[[me,a(s)]]),D("   "),u("label",{for:r.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[D(k(r.value)+" ",1),y(c,null,{default:j(()=>[D(k(r.count),1)]),_:2},1024)],8,Ie)]))),256)),a(t).stats.total_values!=a(t).counts.length?(_(),m("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:d},[u("span",null," show all... ("+k(a(t).stats.total_values)+" total)",1),y(a(De),{class:"h-5 w-5"})])):F("",!0)])}}}),qe={class:"text-right"},Ue=T({__name:"internal-link",props:{href:{}},setup(e){return(n,s)=>{const l=Oe;return _(),R(l,{href:n.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:j(()=>[u("span",null,[le(n.$slots,"default",{},()=>[D(k(n.href),1)])]),D("   "),u("span",qe,[y(a(Ce),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});function I(e,n,...s){if(e in n){let t=n[e];return typeof t=="function"?t(...s):t}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(n).map(t=>`"${t}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,I),l}var z=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(z||{}),Ve=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Ve||{});function G({visible:e=!0,features:n=0,ourProps:s,theirProps:l,...t}){var d;let i=ie(l,s),o=Object.assign(t,{props:i});if(e||n&2&&i.static)return U(o);if(n&1){let c=(d=i.unmount)==null||d?0:1;return I(c,{[0](){return null},[1](){return U({...t,props:{...i,hidden:!0,style:{display:"none"}}})}})}return U(o)}function U({props:e,attrs:n,slots:s,slot:l,name:t}){var d,i;let{as:o,...c}=Fe(e,["unmount","static"]),r=(d=s.default)==null?void 0:d.call(s,l),b={};if(l){let g=!1,p=[];for(let[f,x]of Object.entries(l))typeof x=="boolean"&&(g=!0),x===!0&&p.push(f);g&&(b["data-headlessui-state"]=p.join(" "))}if(o==="template"){if(r=re(r??[]),Object.keys(c).length>0||Object.keys(n).length>0){let[g,...p]=r??[];if(!Re(g)||p.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${t} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(c).concat(Object.keys(n)).map(v=>v.trim()).filter((v,$,C)=>C.indexOf(v)===$).sort((v,$)=>v.localeCompare($)).map(v=>`  - ${v}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>`  - ${v}`).join(`
`)].join(`
`));let f=ie((i=g.props)!=null?i:{},c),x=he(g,f);for(let v in f)v.startsWith("on")&&(x.props||(x.props={}),x.props[v]=f[v]);return x}return Array.isArray(r)&&r.length===1?r[0]:r}return ge(o,Object.assign({},c,b),{default:()=>r})}function re(e){return e.flatMap(n=>n.type===A?re(n.children):[n])}function ie(...e){if(e.length===0)return{};if(e.length===1)return e[0];let n={},s={};for(let l of e)for(let t in l)t.startsWith("on")&&typeof l[t]=="function"?(s[t]!=null||(s[t]=[]),s[t].push(l[t])):n[t]=l[t];if(n.disabled||n["aria-disabled"])return Object.assign(n,Object.fromEntries(Object.keys(s).map(l=>[l,void 0])));for(let l in s)Object.assign(n,{[l](t,...d){let i=s[l];for(let o of i){if(t instanceof Event&&t.defaultPrevented)return;o(t,...d)}}});return n}function Fe(e,n=[]){let s=Object.assign({},e);for(let l of n)l in s&&delete s[l];return s}function Re(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let ze=0;function Ke(){return++ze}function ue(){return Ke()}var P=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(P||{});function S(e){var n;return e==null||e.value==null?null:(n=e.value.$el)!=null?n:e.value}let ce=Symbol("Context");var M=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(M||{});function Qe(){return K(ce,null)}function We(e){Q(ce,e)}function ne(e,n){if(e)return e;let s=n??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function Ge(e,n){let s=w(ne(e.value.type,e.value.as));return W(()=>{s.value=ne(e.value.type,e.value.as)}),ae(()=>{var l;s.value||S(n)&&S(n)instanceof HTMLButtonElement&&!((l=S(n))!=null&&l.hasAttribute("type"))&&(s.value="button")}),s}var Je=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Je||{});let de=Symbol("DisclosureContext");function J(e){let n=K(de,null);if(n===null){let s=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,J),s}return n}let pe=Symbol("DisclosurePanelContext");function Xe(){return K(pe,null)}let Ye=T({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:n,attrs:s}){let l=w(e.defaultOpen?0:1),t=w(null),d=w(null),i={buttonId:w(null),panelId:w(null),disclosureState:l,panel:t,button:d,toggleDisclosure(){l.value=I(l.value,{[0]:1,[1]:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(o){i.closeDisclosure();let c=(()=>o?o instanceof HTMLElement?o:o.value instanceof HTMLElement?S(o):S(i.button):S(i.button))();c==null||c.focus()}};return Q(de,i),We(N(()=>I(l.value,{[0]:M.Open,[1]:M.Closed}))),()=>{let{defaultOpen:o,...c}=e,r={open:l.value===0,close:i.close};return G({theirProps:c,ourProps:{},slot:r,slots:n,attrs:s,name:"Disclosure"})}}}),Ze=T({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ue()}`}},setup(e,{attrs:n,slots:s,expose:l}){let t=J("DisclosureButton");W(()=>{t.buttonId.value=e.id}),oe(()=>{t.buttonId.value=null});let d=Xe(),i=N(()=>d===null?!1:d.value===t.panelId.value),o=w(null);l({el:o,$el:o}),i.value||ae(()=>{t.button.value=o.value});let c=Ge(N(()=>({as:e.as,type:n.type})),o);function r(){var p;e.disabled||(i.value?(t.toggleDisclosure(),(p=S(t.button))==null||p.focus()):t.toggleDisclosure())}function b(p){var f;if(!e.disabled)if(i.value)switch(p.key){case P.Space:case P.Enter:p.preventDefault(),p.stopPropagation(),t.toggleDisclosure(),(f=S(t.button))==null||f.focus();break}else switch(p.key){case P.Space:case P.Enter:p.preventDefault(),p.stopPropagation(),t.toggleDisclosure();break}}function g(p){switch(p.key){case P.Space:p.preventDefault();break}}return()=>{let p={open:t.disclosureState.value===0},{id:f,...x}=e,v=i.value?{ref:o,type:c.value,onClick:r,onKeydown:b}:{id:f,ref:o,type:c.value,"aria-expanded":e.disabled?void 0:t.disclosureState.value===0,"aria-controls":S(t.panel)?t.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:r,onKeydown:b,onKeyup:g};return G({ourProps:v,theirProps:x,slot:p,attrs:n,slots:s,name:"DisclosureButton"})}}}),et=T({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ue()}`}},setup(e,{attrs:n,slots:s,expose:l}){let t=J("DisclosurePanel");W(()=>{t.panelId.value=e.id}),oe(()=>{t.panelId.value=null}),l({el:t.panel,$el:t.panel}),Q(pe,t.panelId);let d=Qe(),i=N(()=>d!==null?(d.value&M.Open)===M.Open:t.disclosureState.value===0);return()=>{let o={open:t.disclosureState.value===0,close:t.close},{id:c,...r}=e,b={id:c,ref:t.panel};return G({ourProps:b,theirProps:r,slot:o,attrs:n,slots:s,features:z.RenderStrategy|z.Static,visible:i.value,name:"DisclosurePanel"})}}});const tt={class:"mx-auto flex max-w-container items-center px-2"},nt={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},lt={class:"my-2 flex items-center justify-between"},st=["disabled"],at=u("span",{class:"sr-only"},"Previous Page",-1),ot=["disabled"],rt=u("span",{class:"sr-only"},"Next Page",-1),it={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},ut=u("div",null,"Name",-1),ct=u("div",null,"Institution(s)",-1),dt=u("div",null,"url",-1),pt=u("div",{class:"text-right"},"time",-1),ft=u("div",{class:"col-span-4 border-t"},null,-1),vt={class:"-ml-2 self-center"},_t=["innerHTML"],mt={key:1},ht={class:"self-center"},gt={class:"flex items-center"},yt={class:"self-center text-right"},Ot=T({__name:"search",setup(e){const n=ye();let s=0,l=String(n.query.q||""),t=Number(n.query.page||1),d=Number(n.query.limit||25),i=String(n.query.inst||""),o=w(null),c=w(!0),r=w({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":i?[i]:[]});const b=p=>{const f=[];return Object.entries(p).forEach(([v,$])=>{$&&$.length!=0&&f.push($.map(C=>`${v}:="${C}"`).join("&&"))}),f.join(" && ")},g=async()=>{c.value=!0,o=await ke({q:l,query_by:"edition-name",per_page:25,page:t,facet_by:Object.keys(r.value).join(","),filter_by:b(r.value)}),c.value=!1,s++};return g(),(p,f)=>{var C,X,Y,Z,ee;const x=fe,v=ve,$=Le;return _(),m("div",null,[y(v,null,{default:j(()=>[y(x,null,{default:j(()=>[D("Browse Editions")]),_:1})]),_:1}),u("div",tt,[se(u("input",{type:"search","onUpdate:modelValue":f[0]||(f[0]=h=>E(l)?l.value=h:l=h),onInput:f[1]||(f[1]=h=>{E(t)?t.value=1:t=1,g()}),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[be,a(l)]])]),u("div",null,[u("div",nt,[y(a(Ye),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:j(({open:h})=>[y(a(Ze),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:j(()=>[D(k(h?"Hide":"Show")+" Filters... ",1),y(a(q),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),y(a(et),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:j(()=>{var O,B;return[a(c)?F("",!0):(_(!0),m(A,{key:0},V((B=(O=a(o))==null?void 0:O.facet_counts)==null?void 0:B.sort((H,L)=>a(r)[L.field_name].length-a(r)[H.field_name].length),H=>(_(),R($,{class:"pt-2",facet:H,selected:a(r)[H.field_name],onFacetChange:L=>{a(r)[H.field_name]=L,E(t)?t.value=1:t=1,g()}},null,8,["facet","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),a(c)?(_(),R(Se,{key:0,class:"-z-10"},{default:j(()=>[y(a($e),{class:"h-5 w-5 animate-spin"})]),_:1})):(_(),m("div",{class:"min-w-full",key:a(s)},[u("div",lt,[u("button",{class:te(["rounded border p-4 transition",a(t)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(t)<=1,onClick:f[2]||(f[2]=h=>{E(t)?t.value--:t--,g()})},[at,y(a(q),{class:"h-4 w-4 -rotate-90"})],10,st),u("span",null," showing "+k((a(t)-1)*a(d)+1)+" - "+k(Math.min(((C=a(o))==null?void 0:C.found)||1/0,a(t)*a(d)))+" out of "+k((X=a(o))==null?void 0:X.found),1),u("button",{class:te(["rounded border p-4 transition",a(t)*a(d)>=Number((Y=a(o))==null?void 0:Y.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(t)*a(d)>=Number((Z=a(o))==null?void 0:Z.found),onClick:f[3]||(f[3]=h=>{E(t)?t.value++:t++,g()})},[rt,y(a(q),{class:"h-4 w-4 rotate-90"})],10,ot)]),a(c)?F("",!0):(_(),m("div",it,[ut,ct,dt,pt,(_(!0),m(A,null,V((ee=a(o))==null?void 0:ee.hits,h=>(_(),m(A,null,[ft,u("div",vt,[y(Ue,{href:"/editions/"+h.document.id},{default:j(()=>{var O,B;return[(O=h.highlight["edition-name"])!=null&&O.snippet?(_(),m("span",{key:0,innerHTML:(B=h.highlight["edition-name"])==null?void 0:B.snippet},null,8,_t)):(_(),m("span",mt,k(h.document["edition-name"]),1))]}),_:2},1032,["href"])]),u("div",ht,k(h.document["institution-s"].map(O=>O["institution-name"]).join(", ")),1),u("div",gt,[y(je,{href:h.document.url,"icon-only":""},null,8,["href"])]),u("div",yt,k(h.document["time-century"]),1)],64))),256))]))]))])])])}}});export{Ot as default};
