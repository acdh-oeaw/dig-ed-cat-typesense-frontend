import{T as fe,H as _e}from"./components.4a6a23da.js";import{o as i,c as m,a,_ as me,H as ne,f as T,r as x,D as K,B as j,t as w,i as e,F,j as U,g as le,I as ve,J as ae,d as N,k as O,w as k,h as H,b as y,K as he,L as oe,s as re,M as ge,N as ie,l as ye,x as be,v as we,O as R}from"./entry.f6d99ca1.js";import{b as xe,g as ke}from"./use-data.1b76eb83.js";import{k as Se,r as $e,_ as Ce}from"./mapping-objects.459dc651.js";import{_ as ue}from"./nuxt-link.c4d75c68.js";import{c as De}from"./centered.769142a4.js";import{u as te,o as B,c as qe,l as V,H as A,t as ce,b as je,p as Ne,N as se,a as E}from"./use-resolve-button-type.5a4277c0.js";import"./_commonjsHelpers.042e6b4d.js";function Ie(n,t){return i(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Oe(n,t){return i(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function L(n,t){return i(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Be={},Te={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Pe(n,t){return i(),m("div",Te,[ne(n.$slots,"default")])}const Me=me(Be,[["render",Pe]]),Ee=(n,t)=>n.filter((u,l,s)=>l===s.findIndex(d=>d[t]===u[t])),He={class:"flex flex-col"},Le={class:"flex items-center justify-between text-2xl"},Fe={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ve=["id","value"],ze=["for"],Re=T({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(n){const t=n;let u=x(t.selected),l=x(!0),s=x({field_name:t.fieldName,counts:[],stats:{}});const d=async(o=500,p="")=>{var r;l.value=!0;const g=await xe(t.fieldName,o);s.value=(r=g.facet_counts)!=null&&r.length?g.facet_counts[0]:{},l.value=!1};K(async()=>{await d(10)});const v=j(()=>{let o=Ee([...s.value.counts,...t.facets],"value");return o=o.sort(p=>t.selected&&t.selected.includes(p.value)?-1:1),o});return(o,p)=>{var g;return i(),m("div",He,[a("h1",Le,w(e(Se)[o.fieldName]),1),(i(!0),m(F,null,U(v.value,r=>(i(),m("div",Fe,[le(a("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:r.value,value:r.value,onChange:p[0]||(p[0]=b=>o.$emit("facetChange",e(u))),"onUpdate:modelValue":p[1]||(p[1]=b=>ae(u)?u.value=b:u=b)},null,40,Ve),[[ve,e(u)]]),N("   "),a("label",{for:r.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[N(w(r.value)+" ",1),r.count?(i(),O(Me,{key:0},{default:k(()=>[N(w(r.count),1)]),_:2},1024)):H("",!0)],8,ze)]))),256)),((g=e(s).stats)==null?void 0:g.total_values)!=e(s).counts.length?(i(),m("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:p[2]||(p[2]=r=>d())},[a("span",null,"show all... ("+w(e(s).stats.total_values)+" total)",1),y(e(Ie),{class:"h-5 w-5"})])):H("",!0)])}}}),Ue={class:"text-right"},Ke=T({__name:"internal-link",props:{href:{}},setup(n){return(t,u)=>{const l=he("ChevronDownIcon"),s=ue;return i(),O(s,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:k(()=>[a("span",null,[ne(t.$slots,"default",{},()=>[N(w(t.href),1)])]),N("   "),a("span",Ue,[y(l,{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});var Ae=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(Ae||{});let de=Symbol("DisclosureContext");function Q(n){let t=ie(de,null);if(t===null){let u=new Error(`<${n} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,Q),u}return t}let pe=Symbol("DisclosurePanelContext");function Qe(){return ie(pe,null)}let We=T({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(n,{slots:t,attrs:u}){let l=x(n.defaultOpen?0:1),s=x(null),d=x(null),v={buttonId:x(null),panelId:x(null),disclosureState:l,panel:s,button:d,toggleDisclosure(){l.value=te(l.value,{[0]:1,[1]:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(o){v.closeDisclosure();let p=(()=>o?o instanceof HTMLElement?o:o.value instanceof HTMLElement?B(o):B(v.button):B(v.button))();p==null||p.focus()}};return oe(de,v),qe(j(()=>te(l.value,{[0]:V.Open,[1]:V.Closed}))),()=>{let{defaultOpen:o,...p}=n,g={open:l.value===0,close:v.close};return A({theirProps:p,ourProps:{},slot:g,slots:t,attrs:u,name:"Disclosure"})}}}),Je=T({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ce()}`}},setup(n,{attrs:t,slots:u,expose:l}){let s=Q("DisclosureButton");K(()=>{s.buttonId.value=n.id}),re(()=>{s.buttonId.value=null});let d=Qe(),v=j(()=>d===null?!1:d.value===s.panelId.value),o=x(null);l({el:o,$el:o}),v.value||ge(()=>{s.button.value=o.value});let p=je(j(()=>({as:n.as,type:t.type})),o);function g(){var h;n.disabled||(v.value?(s.toggleDisclosure(),(h=B(s.button))==null||h.focus()):s.toggleDisclosure())}function r(h){var c;if(!n.disabled)if(v.value)switch(h.key){case E.Space:case E.Enter:h.preventDefault(),h.stopPropagation(),s.toggleDisclosure(),(c=B(s.button))==null||c.focus();break}else switch(h.key){case E.Space:case E.Enter:h.preventDefault(),h.stopPropagation(),s.toggleDisclosure();break}}function b(h){switch(h.key){case E.Space:h.preventDefault();break}}return()=>{let h={open:s.disclosureState.value===0},{id:c,...f}=n,S=v.value?{ref:o,type:p.value,onClick:g,onKeydown:r}:{id:c,ref:o,type:p.value,"aria-expanded":n.disabled?void 0:s.disclosureState.value===0,"aria-controls":B(s.panel)?s.panelId.value:void 0,disabled:n.disabled?!0:void 0,onClick:g,onKeydown:r,onKeyup:b};return A({ourProps:S,theirProps:f,slot:h,attrs:t,slots:u,name:"DisclosureButton"})}}}),Xe=T({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ce()}`}},setup(n,{attrs:t,slots:u,expose:l}){let s=Q("DisclosurePanel");K(()=>{s.panelId.value=n.id}),re(()=>{s.panelId.value=null}),l({el:s.panel,$el:s.panel}),oe(pe,s.panelId);let d=Ne(),v=j(()=>d!==null?(d.value&V.Open)===V.Open:s.disclosureState.value===0);return()=>{let o={open:s.disclosureState.value===0,close:s.close},{id:p,...g}=n,r={id:p,ref:s.panel};return A({ourProps:r,theirProps:g,slot:o,attrs:t,slots:u,features:se.RenderStrategy|se.Static,visible:v.value,name:"DisclosurePanel"})}}});const Ye={class:"mx-auto flex max-w-container items-center px-2"},Ge={class:"grid min-w-full gap-4 divide-y p-4 md:grid-cols-[1fr_4fr] 2xl:grid-cols-[1fr_3fr_1fr] 2xl:gap-32 2xl:divide-y-0 2xl:px-16"},Ze={key:1,class:"text-gray-400 italic"},et={key:1,class:"min-w-full"},tt={class:"my-2 flex items-center justify-between"},st=["disabled"],nt=a("span",{class:"sr-only"},"Previous Page",-1),lt=["disabled"],at=a("span",{class:"sr-only"},"Next Page",-1),ot={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},rt=a("span",{class:"sr-only"},"Click to sort by Name",-1),it=a("div",null,"Institution(s)",-1),ut=a("div",null,"url",-1),ct=a("div",{class:"text-right"},"Time",-1),dt=a("div",{class:"col-span-4 border-t"},null,-1),pt={class:"-ml-2 self-center"},ft=["innerHTML"],_t={key:1},mt={class:"self-center"},vt={class:"flex items-center"},ht={class:"self-center text-right"},gt={key:0,class:"col-span-4 border-t italic text-gray-300 text-center"},Dt=T({__name:"search",setup(n){const t=ye();let u=String(t.query.q||"");const l=x(null);let s=x(!0),d=x({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":[]});const v=(c,f=!1)=>{const S=[];Object.entries(c).forEach(([q,$])=>{$&&$.length!=0&&S.push(q+":=[`"+$.join("`,`")+"`]")});const D=S.join("&&");return f?encodeURIComponent(D).replace("=",""):D},o=(c,f=!1)=>{const D=(f?decodeURIComponent(c):c).split("&&"),q={...d.value};return D.forEach($=>{var M;const P=$.split(":=");q[P[0]]=JSON.parse((M=String(P[1]))==null?void 0:M.replaceAll("`",'"'))}),q},p=c=>{switch(t.query.sort_by){case`${c}:asc`:return`${c}:desc`;case`${c}:desc`:return"";default:return`${c}:asc`}};t.query.facets&&(d.value=o(String(t.query.facets),!0));const g=async(c="",f=1,S=25,D="",q="")=>{s.value=!0;const $=await ke({q:c,query_by:"edition-name",per_page:S,page:f,facet_by:Object.keys(d.value).join(","),filter_by:D,sort_by:q});l.value=$,s.value=!1},r=j(()=>Number(t.query.page)||1),b=j(()=>Number(t.query.limit)||25),h=j(()=>window.innerWidth);return be(t,c=>{const f=c.query;g(String(f.q||""),r.value||1,b.value||25,decodeURIComponent(String(f.facets||"")),String(f.sort_by||""))},{immediate:!0}),(c,f)=>{var P,M,W,J,X,Y,G,Z,ee;const S=fe,D=_e,q=Re,$=ue;return i(),m("div",null,[y(D,null,{default:k(()=>[y(S,null,{default:k(()=>[N("Browse Editions")]),_:1})]),_:1}),a("div",Ye,[le(a("input",{type:"search","onUpdate:modelValue":f[0]||(f[0]=_=>ae(u)?u.value=_:u=_),onInput:f[1]||(f[1]=_=>c.$router.replace({query:{...e(t).query,q:e(u),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[we,e(u)]])]),a("div",null,[a("div",Ge,[y(e(We),{as:"div",class:"flex flex-col pt-10","default-open":e(h)>768},{default:k(({open:_})=>[y(e(Je),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:k(()=>[N(w(_?"Hide":"Show")+" Filters... ",1),y(e(L),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),y(e(Xe),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:k(()=>{var I;return[e(s)?H("",!0):(i(!0),m(F,{key:0},U(((I=e(l))==null?void 0:I.facet_counts).sort((C,z)=>e(d)[z.field_name].length-e(d)[C.field_name].length),C=>(i(),O(q,{class:"pt-2","field-name":C.field_name,facets:C.counts,selected:e(d)[C.field_name],onFacetChange:z=>{e(d)[C.field_name]=z,c.$router.push({query:{...e(t).query,facets:v(e(d),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1},8,["default-open"]),e(s)||!((P=e(l))!=null&&P.found)?(i(),O(De,{key:0,class:"-z-10"},{default:k(()=>[e(s)?(i(),O(e($e),{key:0,class:"h-5 w-5 animate-spin"})):(i(),m("span",Ze,"Nothing found."))]),_:1})):(i(),m("div",et,[a("div",tt,[a("button",{class:R(["rounded border p-4 transition",e(r)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(r)<=1,onClick:f[2]||(f[2]=_=>c.$router.push({query:{...e(t).query,page:e(r)-1}}))},[nt,y(e(L),{class:"h-4 w-4 -rotate-90"})],10,st),a("span",null," showing "+w((e(r)-1)*e(b)+1)+" - "+w(Math.min(((M=e(l))==null?void 0:M.found)||1/0,e(r)*e(b)))+" out of "+w((W=e(l))==null?void 0:W.found),1),a("button",{class:R(["rounded border p-4 transition",e(r)*e(b)>=Number((J=e(l))==null?void 0:J.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(r)*e(b)>=Number((X=e(l))==null?void 0:X.found),onClick:f[3]||(f[3]=_=>c.$router.push({query:{...e(t).query,page:e(r)+1}}))},[at,y(e(L),{class:"h-4 w-4 rotate-90"})],10,lt)]),!e(s)&&((Y=e(l))!=null&&Y.found)?(i(),m("div",ot,[a("div",null,[y($,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...e(t).query,page:1,sort_by:p("edition-name")}}},{default:k(()=>{var _;return[N(" Name "),e(t).query.sort_by&&e(t).query.sort_by.includes("edition-name")?(i(),O(e(L),{key:0,class:R([{"rotate-180":!((_=e(t).query.sort_by)!=null&&_.includes("desc"))},"w-5 h-5"])},null,8,["class"])):(i(),O(e(Oe),{key:1,class:"w-5 h-5 opacity-50"})),rt]}),_:1},8,["to"])]),it,ut,ct,(i(!0),m(F,null,U((G=e(l))==null?void 0:G.hits,_=>(i(),m(F,null,[dt,a("div",pt,[y(Ke,{href:"/editions/"+_.document.id},{default:k(()=>{var I,C;return[(I=_.highlight["edition-name"])!=null&&I.snippet?(i(),m("span",{key:0,innerHTML:(C=_.highlight["edition-name"])==null?void 0:C.snippet},null,8,ft)):(i(),m("span",_t,w(_.document["edition-name"]),1))]}),_:2},1032,["href"])]),a("div",mt,w(_.document["institution-s"].map(I=>I["institution-name"]).join(", ")),1),a("div",vt,[y(Ce,{href:_.document.url,"icon-only":""},null,8,["href"])]),a("div",ht,w(_.document["time-century"]),1)],64))),256)),Math.min(((Z=e(l))==null?void 0:Z.found)||1/0,e(r)*e(b))===((ee=e(l))==null?void 0:ee.found)?(i(),m("div",gt," You've reached the end. ")):H("",!0)])):H("",!0)]))])])])}}});export{Dt as default};
