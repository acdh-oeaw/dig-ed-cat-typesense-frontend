import{T as me,H as _e}from"./components.0ffd5813.js";import{o,c as _,a as n,_ as ve,H as ne,f as M,r as w,D as K,B as I,t as b,i as e,F,j as U,g as ae,I as he,J as oe,d as $,k as N,w as k,h as O,b as y,K as re,s as ie,L as ge,M as ue,l as ye,x as be,v as xe,N as R}from"./entry.94ce017b.js";import{b as we,g as ke}from"./use-data.1b76eb83.js";import{k as $e,r as Se,_ as te}from"./mapping-objects.c844b3ef.js";import{_ as ce}from"./nuxt-link.726eb1c9.js";import{c as qe}from"./centered.0e1f6dbf.js";import{u as se,o as T,c as De,l as V,H as A,t as de,b as Ce,p as je,N as le,a as L}from"./use-resolve-button-type.d13255c2.js";import"./_commonjsHelpers.042e6b4d.js";function Ne(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Ie(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function Be(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function H(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Oe={},Te={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Me(l,t){return o(),_("div",Te,[ne(l.$slots,"default")])}const Pe=ve(Oe,[["render",Me]]),Ee=(l,t)=>l.filter((u,a,s)=>a===s.findIndex(d=>d[t]===u[t])),Le={class:"flex flex-col"},He={class:"flex items-center justify-between text-2xl"},Fe={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ve=["id","value"],ze=["for"],Re=M({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(l){const t=l;let u=w(t.selected),a=w(!0),s=w({field_name:t.fieldName,counts:[],stats:{}});const d=async(r=500,p="")=>{var i;a.value=!0;const g=await we(t.fieldName,r);s.value=(i=g.facet_counts)!=null&&i.length?g.facet_counts[0]:{},a.value=!1};K(async()=>{await d(10)});const v=I(()=>{let r=Ee([...s.value.counts,...t.facets],"value");return r=r.sort(p=>t.selected&&t.selected.includes(p.value)?-1:1),r});return(r,p)=>{var g;return o(),_("div",Le,[n("h1",He,b(e($e)[r.fieldName]),1),(o(!0),_(F,null,U(v.value,i=>(o(),_("div",Fe,[ae(n("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:i.value,value:i.value,onChange:p[0]||(p[0]=x=>r.$emit("facetChange",e(u))),"onUpdate:modelValue":p[1]||(p[1]=x=>oe(u)?u.value=x:u=x)},null,40,Ve),[[he,e(u)]]),$("   "),n("label",{for:i.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[$(b(i.value)+" ",1),i.count?(o(),N(Pe,{key:0},{default:k(()=>[$(b(i.count),1)]),_:2},1024)):O("",!0)],8,ze)]))),256)),((g=e(s).stats)==null?void 0:g.total_values)!=e(s).counts.length?(o(),_("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:p[2]||(p[2]=i=>d())},[n("span",null,"show all... ("+b(e(s).stats.total_values)+" total)",1),y(e(Ne),{class:"h-5 w-5"})])):O("",!0)])}}}),Ue={class:"text-right"},Ke=M({__name:"internal-link",props:{href:{}},setup(l){return(t,u)=>{const a=ce;return o(),N(a,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:k(()=>[n("span",null,[ne(t.$slots,"default",{},()=>[$(b(t.href),1)])]),$("   "),n("span",Ue,[y(e(Ie),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});var Ae=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(Ae||{});let pe=Symbol("DisclosureContext");function Q(l){let t=ue(pe,null);if(t===null){let u=new Error(`<${l} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,Q),u}return t}let fe=Symbol("DisclosurePanelContext");function Qe(){return ue(fe,null)}let We=M({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(l,{slots:t,attrs:u}){let a=w(l.defaultOpen?0:1),s=w(null),d=w(null),v={buttonId:w(null),panelId:w(null),disclosureState:a,panel:s,button:d,toggleDisclosure(){a.value=se(a.value,{[0]:1,[1]:0})},closeDisclosure(){a.value!==1&&(a.value=1)},close(r){v.closeDisclosure();let p=(()=>r?r instanceof HTMLElement?r:r.value instanceof HTMLElement?T(r):T(v.button):T(v.button))();p==null||p.focus()}};return re(pe,v),De(I(()=>se(a.value,{[0]:V.Open,[1]:V.Closed}))),()=>{let{defaultOpen:r,...p}=l,g={open:a.value===0,close:v.close};return A({theirProps:p,ourProps:{},slot:g,slots:t,attrs:u,name:"Disclosure"})}}}),Je=M({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${de()}`}},setup(l,{attrs:t,slots:u,expose:a}){let s=Q("DisclosureButton");K(()=>{s.buttonId.value=l.id}),ie(()=>{s.buttonId.value=null});let d=Qe(),v=I(()=>d===null?!1:d.value===s.panelId.value),r=w(null);a({el:r,$el:r}),v.value||ge(()=>{s.button.value=r.value});let p=Ce(I(()=>({as:l.as,type:t.type})),r);function g(){var h;l.disabled||(v.value?(s.toggleDisclosure(),(h=T(s.button))==null||h.focus()):s.toggleDisclosure())}function i(h){var c;if(!l.disabled)if(v.value)switch(h.key){case L.Space:case L.Enter:h.preventDefault(),h.stopPropagation(),s.toggleDisclosure(),(c=T(s.button))==null||c.focus();break}else switch(h.key){case L.Space:case L.Enter:h.preventDefault(),h.stopPropagation(),s.toggleDisclosure();break}}function x(h){switch(h.key){case L.Space:h.preventDefault();break}}return()=>{let h={open:s.disclosureState.value===0},{id:c,...f}=l,S=v.value?{ref:r,type:p.value,onClick:g,onKeydown:i}:{id:c,ref:r,type:p.value,"aria-expanded":l.disabled?void 0:s.disclosureState.value===0,"aria-controls":T(s.panel)?s.panelId.value:void 0,disabled:l.disabled?!0:void 0,onClick:g,onKeydown:i,onKeyup:x};return A({ourProps:S,theirProps:f,slot:h,attrs:t,slots:u,name:"DisclosureButton"})}}}),Xe=M({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${de()}`}},setup(l,{attrs:t,slots:u,expose:a}){let s=Q("DisclosurePanel");K(()=>{s.panelId.value=l.id}),ie(()=>{s.panelId.value=null}),a({el:s.panel,$el:s.panel}),re(fe,s.panelId);let d=je(),v=I(()=>d!==null?(d.value&V.Open)===V.Open:s.disclosureState.value===0);return()=>{let r={open:s.disclosureState.value===0,close:s.close},{id:p,...g}=l,i={id:p,ref:s.panel};return A({ourProps:i,theirProps:g,slot:r,attrs:t,slots:u,features:le.RenderStrategy|le.Static,visible:v.value,name:"DisclosurePanel"})}}});const Ye={class:"mx-auto flex max-w-container items-center p-2 md:p-0"},Ge={class:"grid min-w-full h-full gap-4 divide-y md:divide-y-0 p-4 grid-rows-[auto_1fr] md:grid-rows-1 md:grid-cols-[1fr_4fr] 2xl:grid-cols-[1fr_3fr_1fr] 2xl:gap-32 2xl:divide-y-0 2xl:px-16"},Ze={key:1,class:"text-gray-400 italic"},et={key:1,class:"w-full max-w-container mx-auto"},tt={class:"my-2 flex items-center justify-between"},st=["disabled"],lt=n("span",{class:"sr-only"},"Previous Page",-1),nt=["disabled"],at=n("span",{class:"sr-only"},"Next Page",-1),ot={key:0,class:"grid min-w-full grid-cols-1 md:grid-cols-[auto_5fr_3fr_auto_auto] gap-x-8 gap-y-1"},rt={class:"hidden items-center gap-2 p-1 -m-1 md:flex"},it=n("span",{class:"sr-only"},"Click to sort by Name",-1),ut=n("div",{class:"hidden md:block"},"Institution(s)",-1),ct=n("div",{class:"hidden md:block"},"url",-1),dt=n("div",{class:"text-right hidden md:block"},"Time",-1),pt=n("div",{class:"md:col-span-5 border-t"},null,-1),ft={class:"self-center text-gray-500 text-sm md:text-base md:text-black"},mt=n("span",{class:"md:hidden"},"ID:",-1),_t={class:"-ml-2 self-center"},vt=["innerHTML"],ht={key:1},gt={class:"self-center"},yt={class:"items-center flex"},bt={class:"self-center md:text-right"},xt={key:0,class:"md:col-span-4 border-t italic text-gray-300 text-center"},Nt=M({__name:"search",setup(l){const t=ye();let u=String(t.query.q||"");const a=w(null);let s=w(!0),d=w({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":[]});const v=(c,f=!1)=>{const S=[];Object.entries(c).forEach(([j,q])=>{q&&q.length!=0&&S.push(j+":=[`"+q.join("`,`")+"`]")});const C=S.join("&&");return f?encodeURIComponent(C).replace("=",""):C},r=(c,f=!1)=>{const C=(f?decodeURIComponent(c):c).split("&&"),j={...d.value};return C.forEach(q=>{var E;const P=q.split(":=");j[P[0]]=JSON.parse((E=String(P[1]))==null?void 0:E.replaceAll("`",'"'))}),j},p=c=>{switch(t.query.sort_by){case`${c}:asc`:return`${c}:desc`;case`${c}:desc`:return"";default:return`${c}:asc`}};t.query.facets&&(d.value=r(String(t.query.facets),!0));const g=async(c="",f=1,S=25,C="",j="")=>{s.value=!0;const q=await ke({q:c,query_by:"edition-name",per_page:S,page:f,facet_by:Object.keys(d.value).join(","),filter_by:C,sort_by:j});a.value=q,s.value=!1},i=I(()=>Number(t.query.page)||1),x=I(()=>Number(t.query.limit)||25),h=I(()=>window.innerWidth);return be(t,c=>{const f=c.query;g(String(f.q||""),i.value||1,x.value||25,decodeURIComponent(String(f.facets||"")),String(f.sort_by||""))},{immediate:!0}),(c,f)=>{var P,E,W,J,X,Y,G,Z,ee;const S=me,C=_e,j=Re,q=ce;return o(),_("div",null,[y(C,null,{default:k(()=>[y(S,null,{default:k(()=>[$("Browse Editions")]),_:1})]),_:1}),n("div",Ye,[ae(n("input",{type:"search","onUpdate:modelValue":f[0]||(f[0]=m=>oe(u)?u.value=m:u=m),onInput:f[1]||(f[1]=m=>c.$router.replace({query:{...e(t).query,q:e(u),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow-md",placeholder:"Search..."},null,544),[[xe,e(u)]])]),n("div",Ge,[y(e(We),{as:"div",class:"flex flex-col pt-10","default-open":e(h)>768},{default:k(({open:m})=>[y(e(Je),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:k(()=>[$(b(m?"Hide":"Show")+" Filters... ",1),y(e(H),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),y(e(Xe),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:k(()=>{var B;return[e(s)?O("",!0):(o(!0),_(F,{key:0},U(((B=e(a))==null?void 0:B.facet_counts).sort((D,z)=>e(d)[z.field_name].length-e(d)[D.field_name].length),D=>(o(),N(j,{class:"pt-2","field-name":D.field_name,facets:D.counts,selected:e(d)[D.field_name],onFacetChange:z=>{e(d)[D.field_name]=z,c.$router.push({query:{...e(t).query,facets:v(e(d),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1},8,["default-open"]),e(s)||!((P=e(a))!=null&&P.found)?(o(),N(qe,{key:0,class:"-z-10"},{default:k(()=>[e(s)?(o(),N(e(Se),{key:0,class:"h-5 w-5 animate-spin"})):(o(),_("span",Ze,"Nothing found."))]),_:1})):(o(),_("div",et,[n("div",tt,[n("button",{class:R(["rounded border p-4 transition",e(i)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(i)<=1,onClick:f[2]||(f[2]=m=>c.$router.push({query:{...e(t).query,page:e(i)-1}}))},[lt,y(e(H),{class:"h-4 w-4 -rotate-90"})],10,st),n("span",null," showing "+b((e(i)-1)*e(x)+1)+" - "+b(Math.min(((E=e(a))==null?void 0:E.found)||1/0,e(i)*e(x)))+" out of "+b((W=e(a))==null?void 0:W.found),1),n("button",{class:R(["rounded border p-4 transition",e(i)*e(x)>=Number((J=e(a))==null?void 0:J.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(i)*e(x)>=Number((X=e(a))==null?void 0:X.found),onClick:f[3]||(f[3]=m=>c.$router.push({query:{...e(t).query,page:e(i)+1}}))},[at,y(e(H),{class:"h-4 w-4 rotate-90"})],10,nt)]),!e(s)&&((Y=e(a))!=null&&Y.found)?(o(),_("div",ot,[n("div",null,[n("div",rt,[$(" ID "),e(t).query.sort_by?O("",!0):(o(),N(e(H),{key:0,class:"w-4 h-4 rotate-180 opacity-50"}))])]),n("div",null,[y(q,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...e(t).query,page:1,sort_by:p("edition-name")}}},{default:k(()=>{var m;return[$(" Name "),e(t).query.sort_by&&e(t).query.sort_by.includes("edition-name")?(o(),N(e(H),{key:0,class:R([{"rotate-180":!((m=e(t).query.sort_by)!=null&&m.includes("desc"))},"w-4 h-4"])},null,8,["class"])):(o(),N(e(Be),{key:1,class:"w-5 h-5 opacity-50"})),it]}),_:1},8,["to"])]),ut,ct,dt,(o(!0),_(F,null,U((G=e(a))==null?void 0:G.hits,m=>(o(),_(F,null,[pt,n("div",ft,[mt,$(" "+b(m.document.id),1)]),n("div",_t,[y(Ke,{href:"/editions/"+m.document.id},{default:k(()=>{var B,D;return[(B=m.highlight["edition-name"])!=null&&B.snippet?(o(),_("span",{key:0,innerHTML:(D=m.highlight["edition-name"])==null?void 0:D.snippet},null,8,vt)):(o(),_("span",ht,b(m.document["edition-name"]),1))]}),_:2},1032,["href"])]),n("div",gt,b(m.document["institution-s"].map(B=>B["institution-name"]).join(", ")),1),n("div",yt,[y(te,{class:"hidden md:flex",href:m.document.url,"icon-only":""},null,8,["href"]),y(te,{class:"md:hidden",href:m.document.url},null,8,["href"])]),n("div",bt,b(m.document["time-century"]),1)],64))),256)),Math.min(((Z=e(a))==null?void 0:Z.found)||1/0,e(i)*e(x))===((ee=e(a))==null?void 0:ee.found)?(o(),_("div",xt," You've reached the end. ")):O("",!0)])):O("",!0)]))])])}}});export{Nt as default};
