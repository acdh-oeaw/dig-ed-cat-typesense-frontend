import{T as fe,H as me}from"./components.4cb4804e.js";import{o,c as _,a as n,_ as _e,k as ve,f as H,q as ae,r as w,H as R,E as N,t as x,h as e,F as L,m as A,i as ne,J as ye,M as oe,d as I,n as j,w as q,j as B,b,N as re,z as ie,O as he,P as ue,A as ge,v as be,s as z}from"./entry.8cd1afa1.js";import{c as xe,g as we}from"./use-data.5c59bd20.js";import{k as ke,p as $e,a as Se,e as qe,r as De,_ as Ce}from"./types.c84e930b.js";import{_ as Ne}from"./nuxt-link.11b798de.js";import{c as je}from"./centered.fbcf6b9e.js";import{_ as te}from"./external-link.vue.97d01b71.js";import{_ as Ie}from"./internal-link.vue.92ca3af0.js";import{u as se,o as O,c as Be,l as U,H as K,t as ce,b as Oe,p as Te,N as le,a as E}from"./use-resolve-button-type.6e6db4e7.js";import"./_commonjsHelpers.042e6b4d.js";function Pe(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Me(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function F(l,t){return o(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ee={},Fe={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function He(l,t){return o(),_("div",Fe,[ve(l.$slots,"default")])}const Le=_e(Ee,[["render",He]]),Ue=(l,t)=>l.filter((y,a,s)=>a===s.findIndex(r=>r[t]===y[t])),Ve=l=>l.charAt(0).toUpperCase()+l.slice(1),ze={class:"flex flex-col"},Ae={class:"flex items-center justify-between text-2xl"},Re={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ke=["id","value"],Qe=["for"],We={key:0},Je={key:1},Xe=H({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(l){const t=l,y=ae();let a=w(t.selected),s=w(!0),r=w({field_name:t.fieldName,counts:[],stats:{}});const g=async(u=500,h="")=>{var d;s.value=!0;const c=await xe(t.fieldName,u,y.query);r.value=(d=c.facet_counts)!=null&&d.length?c.facet_counts[0]:{},s.value=!1};R(async()=>{await g(10)});const v=N(()=>{let u=Ue([...r.value.counts,...t.facets],"value");return u=u.sort(h=>t.selected&&t.selected.includes(h.value)?-1:1),u});return(u,h)=>{var c;return o(),_("div",ze,[n("h1",Ae,x(e(ke)[u.fieldName]),1),(o(!0),_(L,null,A(v.value,d=>(o(),_("div",Re,[ne(n("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:`${u.fieldName}:${d.value}`,value:d.value,onChange:h[0]||(h[0]=p=>u.$emit("facetChange",e(a))),"onUpdate:modelValue":h[1]||(h[1]=p=>oe(a)?a.value=p:a=p)},null,40,Ke),[[ye,e(a)]]),I(" Â  "),n("label",{for:`${u.fieldName}:${d.value}`,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[e($e).includes(d.value)?(o(),_("span",We,x(e(Ve)(e(Se)[d.value])),1)):(o(),_("span",Je,x(d.value),1)),d.count?(o(),j(Le,{key:2},{default:q(()=>[I(x(d.count),1)]),_:2},1024)):B("",!0)],8,Qe)]))),256)),((c=e(r).stats)==null?void 0:c.total_values)!=e(r).counts.length?(o(),_("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:h[2]||(h[2]=d=>g())},[n("span",null,"show all... ("+x(e(r).stats.total_values)+" total)",1),b(e(Pe),{class:"h-5 w-5"})])):B("",!0)])}}});var Ye=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(Ye||{});let de=Symbol("DisclosureContext");function Q(l){let t=ue(de,null);if(t===null){let y=new Error(`<${l} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(y,Q),y}return t}let pe=Symbol("DisclosurePanelContext");function Ge(){return ue(pe,null)}let Ze=H({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(l,{slots:t,attrs:y}){let a=w(l.defaultOpen?0:1),s=w(null),r=w(null),g={buttonId:w(null),panelId:w(null),disclosureState:a,panel:s,button:r,toggleDisclosure(){a.value=se(a.value,{[0]:1,[1]:0})},closeDisclosure(){a.value!==1&&(a.value=1)},close(v){g.closeDisclosure();let u=(()=>v?v instanceof HTMLElement?v:v.value instanceof HTMLElement?O(v):O(g.button):O(g.button))();u==null||u.focus()}};return re(de,g),Be(N(()=>se(a.value,{[0]:U.Open,[1]:U.Closed}))),()=>{let{defaultOpen:v,...u}=l,h={open:a.value===0,close:g.close};return K({theirProps:u,ourProps:{},slot:h,slots:t,attrs:y,name:"Disclosure"})}}}),et=H({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ce()}`}},setup(l,{attrs:t,slots:y,expose:a}){let s=Q("DisclosureButton");R(()=>{s.buttonId.value=l.id}),ie(()=>{s.buttonId.value=null});let r=Ge(),g=N(()=>r===null?!1:r.value===s.panelId.value),v=w(null);a({el:v,$el:v}),g.value||he(()=>{s.button.value=v.value});let u=Oe(N(()=>({as:l.as,type:t.type})),v);function h(){var p;l.disabled||(g.value?(s.toggleDisclosure(),(p=O(s.button))==null||p.focus()):s.toggleDisclosure())}function c(p){var i;if(!l.disabled)if(g.value)switch(p.key){case E.Space:case E.Enter:p.preventDefault(),p.stopPropagation(),s.toggleDisclosure(),(i=O(s.button))==null||i.focus();break}else switch(p.key){case E.Space:case E.Enter:p.preventDefault(),p.stopPropagation(),s.toggleDisclosure();break}}function d(p){switch(p.key){case E.Space:p.preventDefault();break}}return()=>{let p={open:s.disclosureState.value===0},{id:i,...f}=l,k=g.value?{ref:v,type:u.value,onClick:h,onKeydown:c}:{id:i,ref:v,type:u.value,"aria-expanded":l.disabled?void 0:s.disclosureState.value===0,"aria-controls":O(s.panel)?s.panelId.value:void 0,disabled:l.disabled?!0:void 0,onClick:h,onKeydown:c,onKeyup:d};return K({ourProps:k,theirProps:f,slot:p,attrs:t,slots:y,name:"DisclosureButton"})}}}),tt=H({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ce()}`}},setup(l,{attrs:t,slots:y,expose:a}){let s=Q("DisclosurePanel");R(()=>{s.panelId.value=l.id}),ie(()=>{s.panelId.value=null}),a({el:s.panel,$el:s.panel}),re(pe,s.panelId);let r=Te(),g=N(()=>r!==null?(r.value&U.Open)===U.Open:s.disclosureState.value===0);return()=>{let v={open:s.disclosureState.value===0,close:s.close},{id:u,...h}=l,c={id:u,ref:s.panel};return K({ourProps:c,theirProps:h,slot:v,attrs:t,slots:y,features:le.RenderStrategy|le.Static,visible:g.value,name:"DisclosurePanel"})}}});const st={class:"mx-auto flex max-w-container items-center p-2 md:p-0"},lt={class:"grid min-w-full h-full gap-4 divide-y md:divide-y-0 p-4 grid-rows-[auto_1fr] md:grid-rows-1 md:grid-cols-[1fr_4fr] 2xl:grid-cols-[1fr_3fr_1fr] 2xl:gap-32 2xl:divide-y-0 2xl:px-16"},at={key:1,class:"text-gray-400 italic"},nt={key:1,class:"w-full max-w-container mx-auto"},ot={class:"my-2 flex items-center justify-between"},rt=["disabled"],it=n("span",{class:"sr-only"},"Previous Page",-1),ut=["disabled"],ct=n("span",{class:"sr-only"},"Next Page",-1),dt={key:0,class:"grid min-w-full grid-cols-1 md:grid-cols-[auto_5fr_3fr_auto_auto] gap-x-8 gap-y-1"},pt={class:"hidden items-center gap-2 p-1 -m-1 md:flex"},ft=n("span",{class:"sr-only"},"Click to sort by Name",-1),mt=n("div",{class:"hidden md:block"},"Institution(s)",-1),_t=n("div",{class:"hidden md:block"},"Url",-1),vt=n("div",{class:"text-right hidden md:block"},"Time",-1),yt=n("div",{class:"md:col-span-5 border-t"},null,-1),ht={class:"self-center text-gray-500 text-sm md:text-base md:text-black"},gt=n("span",{class:"md:hidden"},"ID:",-1),bt={class:"-ml-2 self-center"},xt=["innerHTML"],wt={key:1},kt={class:"self-center"},$t={class:"items-center flex"},St={class:"self-center md:text-right"},qt={key:0,class:"md:col-span-5 border-t italic text-gray-300 text-center"},Et=H({__name:"search",setup(l){const t=ae();let y=String(t.query.q||"");const a=w(null);let s=w(!0),r=w(qe);const g=(i,f=!1)=>{const k=[];Object.entries(i).forEach(([C,$])=>{$&&$.length!=0&&k.push(C+":=[`"+$.join("`,`")+"`]")});const D=k.join("&&");return f?encodeURIComponent(D).replace("=",""):D},v=(i,f=!1)=>{const D=(f?decodeURIComponent(i):i).split("&&"),C={...r.value};return D.forEach($=>{var P;const T=$.split(":=");C[T[0]]=JSON.parse((P=String(T[1]))==null?void 0:P.replaceAll("`",'"'))}),C},u=i=>{switch(t.query.sort_by){case`${i}:asc`:return`${i}:desc`;case`${i}:desc`:return"";default:return`${i}:asc`}};t.query.facets&&(r.value=v(String(t.query.facets),!0));const h=async(i="",f=1,k=25,D="",C="")=>{s.value=!0;const $=await we({q:i,query_by:"edition-name",per_page:k,page:f,facet_by:Object.keys(r.value).join(","),filter_by:D,sort_by:C});a.value=$,s.value=!1},c=N(()=>Number(t.query.page)||1),d=N(()=>Number(t.query.limit)||25),p=N(()=>process.browser?window.innerWidth:0);return ge(t,i=>{const f=i.query;h(String(f.q||""),c.value||1,d.value||25,decodeURIComponent(String(f.facets||"")),String(f.sort_by||""))},{immediate:!0}),(i,f)=>{var T,P,W,J,X,Y,G,Z,ee;const k=fe,D=me,C=Xe,$=Ne;return o(),_("div",null,[b(D,null,{default:q(()=>[b(k,null,{default:q(()=>[I("Browse Editions")]),_:1})]),_:1}),n("div",st,[ne(n("input",{type:"search","onUpdate:modelValue":f[0]||(f[0]=m=>oe(y)?y.value=m:y=m),onInput:f[1]||(f[1]=m=>i.$router.replace({query:{...e(t).query,q:e(y),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow-md",placeholder:"Search..."},null,544),[[be,e(y)]])]),n("div",lt,[b(e(Ze),{as:"div",class:"flex flex-col md:pt-10","default-open":e(p)>768},{default:q(({open:m})=>[b(e(et),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:q(()=>[I(x(m?"Hide":"Show")+" Filters... ",1),b(e(F),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),b(e(tt),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:q(()=>{var M;return[e(s)?B("",!0):(o(!0),_(L,{key:0},A(((M=e(a))==null?void 0:M.facet_counts).sort((S,V)=>e(r)[V.field_name].length-e(r)[S.field_name].length),S=>(o(),j(C,{class:"pt-2","field-name":S.field_name,facets:S.counts,selected:e(r)[S.field_name],onFacetChange:V=>{e(r)[S.field_name]=V,i.$router.push({query:{...e(t).query,facets:g(e(r),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1},8,["default-open"]),e(s)||!((T=e(a))!=null&&T.found)?(o(),j(je,{key:0,class:"-z-10"},{default:q(()=>[e(s)?(o(),j(e(De),{key:0,class:"h-5 w-5 animate-spin"})):(o(),_("span",at,"Nothing found."))]),_:1})):(o(),_("div",nt,[n("div",ot,[n("button",{class:z(["rounded border p-4 transition",e(c)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(c)<=1,onClick:f[2]||(f[2]=m=>i.$router.push({query:{...e(t).query,page:e(c)-1}}))},[it,b(e(F),{class:"h-4 w-4 -rotate-90"})],10,rt),n("span",null," showing "+x((e(c)-1)*e(d)+1)+" - "+x(Math.min(((P=e(a))==null?void 0:P.found)||1/0,e(c)*e(d)))+" out of "+x((W=e(a))==null?void 0:W.found),1),n("button",{class:z(["rounded border p-4 transition",e(c)*e(d)>=Number((J=e(a))==null?void 0:J.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(c)*e(d)>=Number((X=e(a))==null?void 0:X.found),onClick:f[3]||(f[3]=m=>i.$router.push({query:{...e(t).query,page:e(c)+1}}))},[ct,b(e(F),{class:"h-4 w-4 rotate-90"})],10,ut)]),!e(s)&&((Y=e(a))!=null&&Y.found)?(o(),_("div",dt,[n("div",null,[n("div",pt,[I(" ID "),e(t).query.sort_by?B("",!0):(o(),j(e(F),{key:0,class:"w-4 h-4 rotate-180 opacity-50"}))])]),n("div",null,[b($,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...e(t).query,page:1,sort_by:u("edition-name")}}},{default:q(()=>{var m;return[I(" Name "),e(t).query.sort_by&&e(t).query.sort_by.includes("edition-name")?(o(),j(e(F),{key:0,class:z([{"rotate-180":!((m=e(t).query.sort_by)!=null&&m.includes("desc"))},"w-4 h-4"])},null,8,["class"])):(o(),j(e(Me),{key:1,class:"w-5 h-5 opacity-50"})),ft]}),_:1},8,["to"])]),mt,_t,vt,(o(!0),_(L,null,A((G=e(a))==null?void 0:G.hits,m=>(o(),_(L,null,[yt,n("div",ht,[gt,I(" "+x(m.document.id),1)]),n("div",bt,[b(Ie,{href:"/editions/"+m.document.id},{default:q(()=>{var M,S;return[(M=m.highlight["edition-name"])!=null&&M.snippet?(o(),_("span",{key:0,innerHTML:(S=m.highlight["edition-name"])==null?void 0:S.snippet},null,8,xt)):(o(),_("span",wt,x(m.document["edition-name"]),1))]}),_:2},1032,["href"])]),n("div",kt,[b(Ce,{institutions:m.document["institution-s"],"no-icons":""},null,8,["institutions"])]),n("div",$t,[b(te,{class:"hidden md:flex text-black",href:m.document.url,"icon-only":""},null,8,["href"]),b(te,{class:"md:hidden",href:m.document.url},null,8,["href"])]),n("div",St,x(m.document["time-century"]),1)],64))),256)),Math.min(((Z=e(a))==null?void 0:Z.found)||1/0,e(c)*e(d))===((ee=e(a))==null?void 0:ee.found)?(o(),_("div",qt," You've reached the end. ")):B("",!0)])):B("",!0)]))])])}}});export{Et as default};
