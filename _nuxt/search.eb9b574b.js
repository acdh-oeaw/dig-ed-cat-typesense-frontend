import{T as me,H as he}from"./components.299c32dc.js";import{o as h,c as y,a as d,_ as ge,H as se,f as N,r as w,D as L,B as P,t as $,i as s,F as B,j as V,g as ae,I as _e,J as oe,d as E,k as I,w as j,h as A,b as k,K as ye,L as be,M as K,N as Q,O as re,s as ie,l as we,x as xe,v as ke,P as ne}from"./entry.c42d2ada.js";import{b as $e,g as Se}from"./use-data.1b76eb83.js";import{k as je,r as Oe,_ as De}from"./mapping-objects.0fe76bd3.js";import{c as Ce}from"./centered.e7e93edf.js";import{_ as Ee}from"./nuxt-link.f9602558.js";import"./_commonjsHelpers.042e6b4d.js";function Pe(e,t){return h(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function qe(e,t){return h(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function R(e,t){return h(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ne={},Te={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Be(e,t){return h(),y("div",Te,[se(e.$slots,"default")])}const Ie=ge(Ne,[["render",Be]]),Ae=(e,t)=>e.filter((a,l,n)=>l===n.findIndex(u=>u[t]===a[t])),He={class:"flex flex-col"},Me={class:"flex items-center justify-between text-2xl"},Le={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ue=["id","value"],Re=["for"],Fe=N({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(e){const t=e;let a=w(t.selected),l=w(!0),n=w({field_name:t.fieldName,counts:[],stats:{}});const u=async(r=500,c="")=>{var v;l.value=!0;const i=await $e(t.fieldName,r);n.value=(v=i.facet_counts)!=null&&v.length?i.facet_counts[0]:{},l.value=!1};L(async()=>{await u(10)});const p=P(()=>{let r=Ae([...n.value.counts,...t.facets],"value");return r=r.sort(c=>t.selected&&t.selected.includes(c.value)?-1:1),r});return(r,c)=>{var i;return h(),y("div",He,[d("h1",Me,$(s(je)[r.fieldName]),1),(h(!0),y(B,null,V(p.value,v=>(h(),y("div",Le,[ae(d("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:v.value,value:v.value,onChange:c[0]||(c[0]=f=>r.$emit("facetChange",s(a))),"onUpdate:modelValue":c[1]||(c[1]=f=>oe(a)?a.value=f:a=f)},null,40,Ue),[[_e,s(a)]]),E("   "),d("label",{for:v.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[E($(v.value)+" ",1),v.count?(h(),I(Ie,{key:0},{default:j(()=>[E($(v.count),1)]),_:2},1024)):A("",!0)],8,Re)]))),256)),((i=s(n).stats)==null?void 0:i.total_values)!=s(n).counts.length?(h(),y("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:c[2]||(c[2]=v=>u())},[d("span",null,"show all... ("+$(s(n).stats.total_values)+" total)",1),k(s(Pe),{class:"h-5 w-5"})])):A("",!0)])}}}),Ve={class:"text-right"},ze=N({__name:"internal-link",props:{href:{}},setup(e){return(t,a)=>{const l=Ee;return h(),I(l,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:j(()=>[d("span",null,[se(t.$slots,"default",{},()=>[E($(t.href),1)])]),E("   "),d("span",Ve,[k(s(qe),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});function M(e,t,...a){if(e in t){let n=t[e];return typeof n=="function"?n(...a):n}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,M),l}var z=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(z||{}),Ke=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Ke||{});function W({visible:e=!0,features:t=0,ourProps:a,theirProps:l,...n}){var u;let p=ce(l,a),r=Object.assign(n,{props:p});if(e||t&2&&p.static)return F(r);if(t&1){let c=(u=p.unmount)==null||u?0:1;return M(c,{[0](){return null},[1](){return F({...n,props:{...p,hidden:!0,style:{display:"none"}}})}})}return F(r)}function F({props:e,attrs:t,slots:a,slot:l,name:n}){var u,p;let{as:r,...c}=Qe(e,["unmount","static"]),i=(u=a.default)==null?void 0:u.call(a,l),v={};if(l){let f=!1,o=[];for(let[g,_]of Object.entries(l))typeof _=="boolean"&&(f=!0),_===!0&&o.push(g);f&&(v["data-headlessui-state"]=o.join(" "))}if(r==="template"){if(i=ue(i??[]),Object.keys(c).length>0||Object.keys(t).length>0){let[f,...o]=i??[];if(!We(f)||o.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${n} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(c).concat(Object.keys(t)).map(m=>m.trim()).filter((m,x,D)=>D.indexOf(m)===x).sort((m,x)=>m.localeCompare(x)).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`));let g=ce((p=f.props)!=null?p:{},c),_=ye(f,g);for(let m in g)m.startsWith("on")&&(_.props||(_.props={}),_.props[m]=g[m]);return _}return Array.isArray(i)&&i.length===1?i[0]:i}return be(r,Object.assign({},c,v),{default:()=>i})}function ue(e){return e.flatMap(t=>t.type===B?ue(t.children):[t])}function ce(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},a={};for(let l of e)for(let n in l)n.startsWith("on")&&typeof l[n]=="function"?(a[n]!=null||(a[n]=[]),a[n].push(l[n])):t[n]=l[n];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(a).map(l=>[l,void 0])));for(let l in a)Object.assign(t,{[l](n,...u){let p=a[l];for(let r of p){if(n instanceof Event&&n.defaultPrevented)return;r(n,...u)}}});return t}function Qe(e,t=[]){let a=Object.assign({},e);for(let l of t)l in a&&delete a[l];return a}function We(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let Je=0;function Ye(){return++Je}function de(){return Ye()}var q=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(q||{});function O(e){var t;return e==null||e.value==null?null:(t=e.value.$el)!=null?t:e.value}let pe=Symbol("Context");var H=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(H||{});function Xe(){return K(pe,null)}function Ge(e){Q(pe,e)}function le(e,t){if(e)return e;let a=t??"button";if(typeof a=="string"&&a.toLowerCase()==="button")return"button"}function Ze(e,t){let a=w(le(e.value.type,e.value.as));return L(()=>{a.value=le(e.value.type,e.value.as)}),re(()=>{var l;a.value||O(t)&&O(t)instanceof HTMLButtonElement&&!((l=O(t))!=null&&l.hasAttribute("type"))&&(a.value="button")}),a}var et=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(et||{});let fe=Symbol("DisclosureContext");function J(e){let t=K(fe,null);if(t===null){let a=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,J),a}return t}let ve=Symbol("DisclosurePanelContext");function tt(){return K(ve,null)}let nt=N({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:t,attrs:a}){let l=w(e.defaultOpen?0:1),n=w(null),u=w(null),p={buttonId:w(null),panelId:w(null),disclosureState:l,panel:n,button:u,toggleDisclosure(){l.value=M(l.value,{[0]:1,[1]:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(r){p.closeDisclosure();let c=(()=>r?r instanceof HTMLElement?r:r.value instanceof HTMLElement?O(r):O(p.button):O(p.button))();c==null||c.focus()}};return Q(fe,p),Ge(P(()=>M(l.value,{[0]:H.Open,[1]:H.Closed}))),()=>{let{defaultOpen:r,...c}=e,i={open:l.value===0,close:p.close};return W({theirProps:c,ourProps:{},slot:i,slots:t,attrs:a,name:"Disclosure"})}}}),lt=N({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${de()}`}},setup(e,{attrs:t,slots:a,expose:l}){let n=J("DisclosureButton");L(()=>{n.buttonId.value=e.id}),ie(()=>{n.buttonId.value=null});let u=tt(),p=P(()=>u===null?!1:u.value===n.panelId.value),r=w(null);l({el:r,$el:r}),p.value||re(()=>{n.button.value=r.value});let c=Ze(P(()=>({as:e.as,type:t.type})),r);function i(){var o;e.disabled||(p.value?(n.toggleDisclosure(),(o=O(n.button))==null||o.focus()):n.toggleDisclosure())}function v(o){var g;if(!e.disabled)if(p.value)switch(o.key){case q.Space:case q.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure(),(g=O(n.button))==null||g.focus();break}else switch(o.key){case q.Space:case q.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure();break}}function f(o){switch(o.key){case q.Space:o.preventDefault();break}}return()=>{let o={open:n.disclosureState.value===0},{id:g,..._}=e,m=p.value?{ref:r,type:c.value,onClick:i,onKeydown:v}:{id:g,ref:r,type:c.value,"aria-expanded":e.disabled?void 0:n.disclosureState.value===0,"aria-controls":O(n.panel)?n.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:i,onKeydown:v,onKeyup:f};return W({ourProps:m,theirProps:_,slot:o,attrs:t,slots:a,name:"DisclosureButton"})}}}),st=N({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${de()}`}},setup(e,{attrs:t,slots:a,expose:l}){let n=J("DisclosurePanel");L(()=>{n.panelId.value=e.id}),ie(()=>{n.panelId.value=null}),l({el:n.panel,$el:n.panel}),Q(ve,n.panelId);let u=Xe(),p=P(()=>u!==null?(u.value&H.Open)===H.Open:n.disclosureState.value===0);return()=>{let r={open:n.disclosureState.value===0,close:n.close},{id:c,...i}=e,v={id:c,ref:n.panel};return W({ourProps:v,theirProps:i,slot:r,attrs:t,slots:a,features:z.RenderStrategy|z.Static,visible:p.value,name:"DisclosurePanel"})}}});const at={class:"mx-auto flex max-w-container items-center px-2"},ot={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},rt={key:1,class:"text-gray-400 italic"},it={key:1,class:"min-w-full"},ut={class:"my-2 flex items-center justify-between"},ct=["disabled"],dt=d("span",{class:"sr-only"},"Previous Page",-1),pt=["disabled"],ft=d("span",{class:"sr-only"},"Next Page",-1),vt={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},mt=d("div",null,"Name",-1),ht=d("div",null,"Institution(s)",-1),gt=d("div",null,"url",-1),_t=d("div",{class:"text-right"},"time",-1),yt=d("div",{class:"col-span-4 border-t"},null,-1),bt={class:"-ml-2 self-center"},wt=["innerHTML"],xt={key:1},kt={class:"self-center"},$t={class:"flex items-center"},St={class:"self-center text-right"},jt={key:0,class:"col-span-4 border-t italic text-gray-300 text-center"},Tt=N({__name:"search",setup(e){const t=we();let a=String(t.query.q||"");const l=w(null);let n=w(!0),u=w({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":[]});const p=(f,o=!1)=>{const g=[];Object.entries(f).forEach(([m,x])=>{x&&x.length!=0&&g.push(m+":=[`"+x.join("`,`")+"`]")});const _=g.join("&&");return o?encodeURIComponent(_).replace("=",""):_},r=(f,o=!1)=>{const _=(o?decodeURIComponent(f):f).split("&&"),m={...u.value};return _.forEach(x=>{var T;const D=x.split(":=");m[D[0]]=JSON.parse((T=String(D[1]))==null?void 0:T.replaceAll("`",'"'))}),m};t.query.facets&&(u.value=r(String(t.query.facets),!0));const c=async(f="",o=1,g=25,_="")=>{n.value=!0;const m=await Se({q:f,query_by:"edition-name",per_page:g,page:o,facet_by:Object.keys(u.value).join(","),filter_by:_});l.value=m,n.value=!1},i=P(()=>Number(t.query.page)||1),v=P(()=>Number(t.query.limit)||25);return xe(t,f=>{const o=f.query;c(String(o.q||""),i.value||1,v.value||25,decodeURIComponent(String(o.facets||"")))},{immediate:!0}),(f,o)=>{var x,D,T,Y,X,G,Z,ee,te;const g=me,_=he,m=Fe;return h(),y("div",null,[k(_,null,{default:j(()=>[k(g,null,{default:j(()=>[E("Browse Editions")]),_:1})]),_:1}),d("div",at,[ae(d("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=b=>oe(a)?a.value=b:a=b),onInput:o[1]||(o[1]=b=>f.$router.replace({query:{...s(t).query,q:s(a),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[ke,s(a)]])]),d("div",null,[d("div",ot,[k(s(nt),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:j(({open:b})=>[k(s(lt),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:j(()=>[E($(b?"Hide":"Show")+" Filters... ",1),k(s(R),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),k(s(st),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:j(()=>{var C;return[s(n)?A("",!0):(h(!0),y(B,{key:0},V(((C=s(l))==null?void 0:C.facet_counts).sort((S,U)=>s(u)[U.field_name].length-s(u)[S.field_name].length),S=>(h(),I(m,{class:"pt-2","field-name":S.field_name,facets:S.counts,selected:s(u)[S.field_name],onFacetChange:U=>{s(u)[S.field_name]=U,f.$router.push({query:{...s(t).query,facets:p(s(u),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),s(n)||!((x=s(l))!=null&&x.found)?(h(),I(Ce,{key:0,class:"-z-10"},{default:j(()=>[s(n)?(h(),I(s(Oe),{key:0,class:"h-5 w-5 animate-spin"})):(h(),y("span",rt,"Nothing found."))]),_:1})):(h(),y("div",it,[d("div",ut,[d("button",{class:ne(["rounded border p-4 transition",s(i)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:s(i)<=1,onClick:o[2]||(o[2]=b=>f.$router.push({query:{...s(t).query,page:s(i)-1}}))},[dt,k(s(R),{class:"h-4 w-4 -rotate-90"})],10,ct),d("span",null," showing "+$((s(i)-1)*s(v)+1)+" - "+$(Math.min(((D=s(l))==null?void 0:D.found)||1/0,s(i)*s(v)))+" out of "+$((T=s(l))==null?void 0:T.found),1),d("button",{class:ne(["rounded border p-4 transition",s(i)*s(v)>=Number((Y=s(l))==null?void 0:Y.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:s(i)*s(v)>=Number((X=s(l))==null?void 0:X.found),onClick:o[3]||(o[3]=b=>f.$router.push({query:{...s(t).query,page:s(i)+1}}))},[ft,k(s(R),{class:"h-4 w-4 rotate-90"})],10,pt)]),!s(n)&&((G=s(l))!=null&&G.found)?(h(),y("div",vt,[mt,ht,gt,_t,(h(!0),y(B,null,V((Z=s(l))==null?void 0:Z.hits,b=>(h(),y(B,null,[yt,d("div",bt,[k(ze,{href:"/editions/"+b.document.id},{default:j(()=>{var C,S;return[(C=b.highlight["edition-name"])!=null&&C.snippet?(h(),y("span",{key:0,innerHTML:(S=b.highlight["edition-name"])==null?void 0:S.snippet},null,8,wt)):(h(),y("span",xt,$(b.document["edition-name"]),1))]}),_:2},1032,["href"])]),d("div",kt,$(b.document["institution-s"].map(C=>C["institution-name"]).join(", ")),1),d("div",$t,[k(De,{href:b.document.url,"icon-only":""},null,8,["href"])]),d("div",St,$(b.document["time-century"]),1)],64))),256)),Math.min(((ee=s(l))==null?void 0:ee.found)||1/0,s(i)*s(v))===((te=s(l))==null?void 0:te.found)?(h(),y("div",jt," You've reached the end. ")):A("",!0)])):A("",!0)]))])])])}}});export{Tt as default};
