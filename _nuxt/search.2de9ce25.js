import{o as d,c as f,a as i,_ as ae,q as X,f as S,r as h,t as y,i as e,F as M,k as V,s as J,v as ne,x as P,d as $,b as g,w,y as L,j as H,z as W,A as N,m as Y,B as Z,C as oe,D as ee,g as re,E as ie,G as A}from"./entry.9852beec.js";import{k as ue,a as ce,c as de,b as pe,r as fe,_ as _e}from"./mapping-objects.34c7158f.js";import{r as ve,u as Q,o as D,c as me,l as q,H as z,t as te,b as ge,p as he,N as G,a as O}from"./use-resolve-button-type.f70394f4.js";import{_ as ye}from"./nuxt-link.1abc47eb.js";import"./_commonjsHelpers.042e6b4d.js";function be(l,r){return d(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function F(l,r){return d(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const xe={},we={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function ke(l,r){return d(),f("div",we,[X(l.$slots,"default")])}const $e=ae(xe,[["render",ke]]),De={class:"flex flex-col"},Se={class:"flex items-center justify-between text-2xl"},Ce={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},je=["id","value"],Be=["for"],Oe=S({__name:"facet-field",props:{facet:{},selected:{}},setup(l){const r=l;let u=h(r.selected),s=h(!1),t=h(r.facet);const m=async()=>{var a,c,p;s.value=!0;const n=await ce(t.value.field_name);t.value=(c=(a=n.value)==null?void 0:a.facet_counts)!=null&&c.length?(p=n.value)==null?void 0:p.facet_counts[0]:[],s.value=!1};return console.log("facet",r.facet),(n,a)=>{const c=$e;return d(),f("div",De,[i("h1",Se,y(e(ue)[e(t).field_name]),1),(d(!0),f(M,null,V(e(t).counts,p=>(d(),f("div",Ce,[J(i("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer",id:p.value,value:p.value,onChange:a[0]||(a[0]=_=>n.$emit("facetChange",e(u))),"onUpdate:modelValue":a[1]||(a[1]=_=>P(u)?u.value=_:u=_)},null,40,je),[[ne,e(u)]]),$("   "),i("label",{for:p.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[$(y(p.value)+" ",1),g(c,null,{default:w(()=>[$(y(p.count),1)]),_:2},1024)],8,Be)]))),256)),e(t).stats.total_values!=e(t).counts.length?(d(),f("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:m},[i("span",null," show all... ("+y(e(t).stats.total_values)+" total)",1),g(e(ve),{class:"h-5 w-5"})])):L("",!0)])}}}),Pe={class:"text-right"},Ee=S({__name:"internal-link",props:{href:{}},setup(l){return(r,u)=>{const s=ye;return d(),H(s,{href:r.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:w(()=>[i("span",null,[X(r.$slots,"default",{},()=>[$(y(r.href),1)])]),$("   "),i("span",Pe,[g(e(be),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});var Ie=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(Ie||{});let se=Symbol("DisclosureContext");function K(l){let r=ee(se,null);if(r===null){let u=new Error(`<${l} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,K),u}return r}let le=Symbol("DisclosurePanelContext");function Me(){return ee(le,null)}let Ne=S({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(l,{slots:r,attrs:u}){let s=h(l.defaultOpen?0:1),t=h(null),m=h(null),n={buttonId:h(null),panelId:h(null),disclosureState:s,panel:t,button:m,toggleDisclosure(){s.value=Q(s.value,{[0]:1,[1]:0})},closeDisclosure(){s.value!==1&&(s.value=1)},close(a){n.closeDisclosure();let c=(()=>a?a instanceof HTMLElement?a:a.value instanceof HTMLElement?D(a):D(n.button):D(n.button))();c==null||c.focus()}};return W(se,n),me(N(()=>Q(s.value,{[0]:q.Open,[1]:q.Closed}))),()=>{let{defaultOpen:a,...c}=l,p={open:s.value===0,close:n.close};return z({theirProps:c,ourProps:{},slot:p,slots:r,attrs:u,name:"Disclosure"})}}}),qe=S({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${te()}`}},setup(l,{attrs:r,slots:u,expose:s}){let t=K("DisclosureButton");Y(()=>{t.buttonId.value=l.id}),Z(()=>{t.buttonId.value=null});let m=Me(),n=N(()=>m===null?!1:m.value===t.panelId.value),a=h(null);s({el:a,$el:a}),n.value||oe(()=>{t.button.value=a.value});let c=ge(N(()=>({as:l.as,type:r.type})),a);function p(){var o;l.disabled||(n.value?(t.toggleDisclosure(),(o=D(t.button))==null||o.focus()):t.toggleDisclosure())}function _(o){var x;if(!l.disabled)if(n.value)switch(o.key){case O.Space:case O.Enter:o.preventDefault(),o.stopPropagation(),t.toggleDisclosure(),(x=D(t.button))==null||x.focus();break}else switch(o.key){case O.Space:case O.Enter:o.preventDefault(),o.stopPropagation(),t.toggleDisclosure();break}}function E(o){switch(o.key){case O.Space:o.preventDefault();break}}return()=>{let o={open:t.disclosureState.value===0},{id:x,...k}=l,b=n.value?{ref:a,type:c.value,onClick:p,onKeydown:_}:{id:x,ref:a,type:c.value,"aria-expanded":l.disabled?void 0:t.disclosureState.value===0,"aria-controls":D(t.panel)?t.panelId.value:void 0,disabled:l.disabled?!0:void 0,onClick:p,onKeydown:_,onKeyup:E};return z({ourProps:b,theirProps:k,slot:o,attrs:r,slots:u,name:"DisclosureButton"})}}}),Te=S({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${te()}`}},setup(l,{attrs:r,slots:u,expose:s}){let t=K("DisclosurePanel");Y(()=>{t.panelId.value=l.id}),Z(()=>{t.panelId.value=null}),s({el:t.panel,$el:t.panel}),W(le,t.panelId);let m=he(),n=N(()=>m!==null?(m.value&q.Open)===q.Open:t.disclosureState.value===0);return()=>{let a={open:t.disclosureState.value===0,close:t.close},{id:c,...p}=l,_={id:c,ref:t.panel};return z({ourProps:_,theirProps:p,slot:a,attrs:r,slots:u,features:G.RenderStrategy|G.Static,visible:n.value,name:"DisclosurePanel"})}}});const Fe={class:"mx-auto flex max-w-container items-center px-2"},Ve={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},Le={key:1,class:"min-w-full"},He={class:"my-2 flex items-center justify-between"},ze=["disabled"],Ke=i("span",{class:"sr-only"},"Previous Page",-1),Re=["disabled"],Ue=i("span",{class:"sr-only"},"Next Page",-1),Ae={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_2fr] gap-x-8 gap-y-2"},Qe=i("div",null,"Name",-1),Ge=i("div",null,"url",-1),Xe=i("div",{class:"text-right"},"time",-1),Je={class:"-ml-2"},We=["innerHTML"],Ye={key:1},Ze={class:"flex items-center"},et={class:"flex items-center justify-end"},ot=S({__name:"search",setup(l){const r=re();let u=String(r.query.q||""),s=Number(r.query.page||1),t=Number(r.query.limit||25),m=String(r.query.inst||""),n=h(null),a=h(!0),c=h({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":m?[m]:[]});const p=E=>{const o=[];return Object.entries(E).forEach(([k,b])=>{b&&b.length!=0&&o.push(b.map(I=>`${k}:="${I}"`).join("&&"))}),o.join(" && ")},_=async()=>{a.value=!0,n=await pe({q:u,query_by:"edition-name",per_page:25,page:s,facet_by:Object.keys(c.value).join(","),filter_by:p(c.value)}),console.log(n.value),a.value=!1};return _(),(E,o)=>{var k,b,I,R,U;const x=Oe;return d(),f("div",null,[i("div",Fe,[J(i("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=v=>P(u)?u.value=v:u=v),onInput:o[1]||(o[1]=v=>{P(s)?s.value=1:s=1,_()}),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[ie,e(u)]])]),i("div",null,[i("div",Ve,[g(e(Ne),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:w(({open:v})=>[g(e(qe),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:w(()=>[$(y(v?"Hide":"Show")+" Filters... ",1),g(e(F),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),g(e(Te),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:w(()=>{var C,j;return[e(a)?L("",!0):(d(!0),f(M,{key:0},V((j=(C=e(n))==null?void 0:C.facet_counts)==null?void 0:j.sort((B,T)=>e(c)[T.field_name].length-e(c)[B.field_name].length),B=>(d(),H(x,{class:"pt-2",facet:B,selected:e(c)[B.field_name],onFacetChange:T=>{e(c)[B.field_name]=T,_()}},null,8,["facet","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),e(a)?(d(),H(de,{key:0,class:"-z-10"},{default:w(()=>[g(e(fe),{class:"h-5 w-5 animate-spin"})]),_:1})):(d(),f("div",Le,[i("div",He,[i("button",{class:A(["rounded border p-4 transition",e(s)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(s)<=1,onClick:o[2]||(o[2]=v=>{P(s)?s.value--:s--,_()})},[Ke,g(e(F),{class:"h-4 w-4 -rotate-90"})],10,ze),i("span",null,"showing "+y((e(s)-1)*e(t)+1)+" - "+y(Math.min(((k=e(n))==null?void 0:k.found)||1/0,e(s)*e(t)))+" out of "+y((b=e(n))==null?void 0:b.found),1),i("button",{class:A(["rounded border p-4 transition",e(s)*e(t)>=Number((I=e(n))==null?void 0:I.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(s)*e(t)>=Number((R=e(n))==null?void 0:R.found),onClick:o[3]||(o[3]=v=>{P(s)?s.value++:s++,_()})},[Ue,g(e(F),{class:"h-4 w-4 rotate-90"})],10,Re)]),e(a)?L("",!0):(d(),f("div",Ae,[Qe,Ge,Xe,(d(!0),f(M,null,V((U=e(n))==null?void 0:U.hits,v=>(d(),f(M,null,[i("div",Je,[g(Ee,{href:"/editions/"+v.document.id},{default:w(()=>{var C,j;return[(C=v.highlight["edition-name"])!=null&&C.snippet?(d(),f("span",{key:0,innerHTML:(j=v.highlight["edition-name"])==null?void 0:j.snippet},null,8,We)):(d(),f("span",Ye,y(v.document["edition-name"]),1))]}),_:2},1032,["href"])]),i("div",Ze,[g(_e,{href:v.document.url},null,8,["href"])]),i("div",et,y(v.document["time-century"]),1)],64))),256))]))]))])])])}}});export{ot as default};
