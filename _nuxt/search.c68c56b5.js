import{T as pe,H as fe}from"./components.5f446a8a.js";import{o as r,c as m,a as o,_ as me,k as _e,f as F,q as le,r as x,H as A,E as j,t as b,h as e,F as H,m as z,i as ae,J as ve,M as ne,d as N,n as C,w as q,j as I,b as g,N as oe,z as re,O as ye,P as ie,A as he,v as ge,s as V}from"./entry.6a8fe295.js";import{c as be,g as xe}from"./use-data.5c59bd20.js";import{k as we,p as ke,a as $e,e as Se,r as qe,_ as De}from"./types.25cd2bf6.js";import{_ as Ce}from"./nuxt-link.495cab04.js";import{c as Ne}from"./centered.8385efa0.js";import{_ as ee}from"./external-link.vue.e3877ebc.js";import{_ as je}from"./internal-link.vue.69f97f4e.js";import{u as te,o as B,c as Ie,l as L,H as R,t as ue,b as Be,p as Oe,N as se,a as M}from"./use-resolve-button-type.18f389aa.js";import"./_commonjsHelpers.042e6b4d.js";function Te(a,t){return r(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[o("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Pe(a,t){return r(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[o("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function E(a,t){return r(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[o("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Me={},Ee={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Fe(a,t){return r(),m("div",Ee,[_e(a.$slots,"default")])}const He=me(Me,[["render",Fe]]),Le=(a,t)=>a.filter((v,n,s)=>n===s.findIndex(i=>i[t]===v[t])),Ue=a=>a.charAt(0).toUpperCase()+a.slice(1),Ve={class:"flex flex-col"},ze={class:"flex items-center justify-between text-2xl"},Ae={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Re=["id","value"],Ke=["for"],Qe={key:0},Je={key:1},We=F({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(a){const t=a,v=le();let n=x(t.selected),s=x(!0),i=x({field_name:t.fieldName,counts:[],stats:{}});const h=async(c=500,y="")=>{var p;s.value=!0;const d=await be(t.fieldName,c,v.query);i.value=(p=d.facet_counts)!=null&&p.length?d.facet_counts[0]:{},s.value=!1};A(async()=>{await h(10)});const _=j(()=>{let c=Le([...i.value.counts,...t.facets],"value");return c=c.sort(y=>t.selected&&t.selected.includes(y.value)?-1:1),c});return(c,y)=>{var d;return r(),m("div",Ve,[o("h1",ze,b(e(we)[c.fieldName]),1),(r(!0),m(H,null,z(_.value,p=>(r(),m("div",Ae,[ae(o("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:`${c.fieldName}:${p.value}`,value:p.value,onChange:y[0]||(y[0]=l=>c.$emit("facetChange",e(n))),"onUpdate:modelValue":y[1]||(y[1]=l=>ne(n)?n.value=l:n=l)},null,40,Re),[[ve,e(n)]]),N(" Â  "),o("label",{for:`${c.fieldName}:${p.value}`,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[e(ke).includes(p.value)?(r(),m("span",Qe,b(e(Ue)(e($e)[p.value])),1)):(r(),m("span",Je,b(p.value),1)),p.count?(r(),C(He,{key:2},{default:q(()=>[N(b(p.count),1)]),_:2},1024)):I("",!0)],8,Ke)]))),256)),((d=e(i).stats)==null?void 0:d.total_values)!=e(i).counts.length?(r(),m("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:y[2]||(y[2]=p=>h())},[o("span",null,"show all... ("+b(e(i).stats.total_values)+" total)",1),g(e(Te),{class:"h-5 w-5"})])):I("",!0)])}}});var Xe=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(Xe||{});let ce=Symbol("DisclosureContext");function K(a){let t=ie(ce,null);if(t===null){let v=new Error(`<${a} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,K),v}return t}let de=Symbol("DisclosurePanelContext");function Ye(){return ie(de,null)}let Ge=F({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(a,{slots:t,attrs:v}){let n=x(a.defaultOpen?0:1),s=x(null),i=x(null),h={buttonId:x(null),panelId:x(null),disclosureState:n,panel:s,button:i,toggleDisclosure(){n.value=te(n.value,{[0]:1,[1]:0})},closeDisclosure(){n.value!==1&&(n.value=1)},close(_){h.closeDisclosure();let c=(()=>_?_ instanceof HTMLElement?_:_.value instanceof HTMLElement?B(_):B(h.button):B(h.button))();c==null||c.focus()}};return oe(ce,h),Ie(j(()=>te(n.value,{[0]:L.Open,[1]:L.Closed}))),()=>{let{defaultOpen:_,...c}=a,y={open:n.value===0,close:h.close};return R({theirProps:c,ourProps:{},slot:y,slots:t,attrs:v,name:"Disclosure"})}}}),Ze=F({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ue()}`}},setup(a,{attrs:t,slots:v,expose:n}){let s=K("DisclosureButton");A(()=>{s.buttonId.value=a.id}),re(()=>{s.buttonId.value=null});let i=Ye(),h=j(()=>i===null?!1:i.value===s.panelId.value),_=x(null);n({el:_,$el:_}),h.value||ye(()=>{s.button.value=_.value});let c=Be(j(()=>({as:a.as,type:t.type})),_);function y(){var l;a.disabled||(h.value?(s.toggleDisclosure(),(l=B(s.button))==null||l.focus()):s.toggleDisclosure())}function d(l){var u;if(!a.disabled)if(h.value)switch(l.key){case M.Space:case M.Enter:l.preventDefault(),l.stopPropagation(),s.toggleDisclosure(),(u=B(s.button))==null||u.focus();break}else switch(l.key){case M.Space:case M.Enter:l.preventDefault(),l.stopPropagation(),s.toggleDisclosure();break}}function p(l){switch(l.key){case M.Space:l.preventDefault();break}}return()=>{let l={open:s.disclosureState.value===0},{id:u,...k}=a,w=h.value?{ref:_,type:c.value,onClick:y,onKeydown:d}:{id:u,ref:_,type:c.value,"aria-expanded":a.disabled?void 0:s.disclosureState.value===0,"aria-controls":B(s.panel)?s.panelId.value:void 0,disabled:a.disabled?!0:void 0,onClick:y,onKeydown:d,onKeyup:p};return R({ourProps:w,theirProps:k,slot:l,attrs:t,slots:v,name:"DisclosureButton"})}}}),et=F({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ue()}`}},setup(a,{attrs:t,slots:v,expose:n}){let s=K("DisclosurePanel");A(()=>{s.panelId.value=a.id}),re(()=>{s.panelId.value=null}),n({el:s.panel,$el:s.panel}),oe(de,s.panelId);let i=Oe(),h=j(()=>i!==null?(i.value&L.Open)===L.Open:s.disclosureState.value===0);return()=>{let _={open:s.disclosureState.value===0,close:s.close},{id:c,...y}=a,d={id:c,ref:s.panel};return R({ourProps:d,theirProps:y,slot:_,attrs:t,slots:v,features:se.RenderStrategy|se.Static,visible:h.value,name:"DisclosurePanel"})}}});const tt={class:"mx-auto flex max-w-container items-center p-2 md:p-0"},st={class:"grid min-w-full h-full gap-4 divide-y md:divide-y-0 p-4 grid-rows-[auto_1fr] md:grid-rows-1 md:grid-cols-[1fr_4fr] 2xl:grid-cols-[1fr_3fr_1fr] 2xl:gap-32 2xl:divide-y-0 2xl:px-16"},lt={key:1,class:"text-gray-400 italic"},at={key:1,class:"w-full max-w-container mx-auto"},nt={class:"my-2 flex items-center justify-between"},ot=["disabled"],rt=o("span",{class:"sr-only"},"Previous Page",-1),it=["disabled"],ut=o("span",{class:"sr-only"},"Next Page",-1),ct={key:0,class:"grid min-w-full grid-cols-1 md:grid-cols-[auto_5fr_3fr_auto_auto] gap-x-8 gap-y-1"},dt={class:"hidden items-center gap-2 p-1 -m-1 md:flex"},pt=o("span",{class:"sr-only"},"Click to sort by Name",-1),ft=o("div",{class:"hidden md:block"},"Institution(s)",-1),mt=o("div",{class:"hidden md:block"},"Url",-1),_t=o("div",{class:"text-right hidden md:block"},"Time",-1),vt=o("div",{class:"md:col-span-5 border-t"},null,-1),yt={class:"self-center text-gray-500 text-sm md:text-base md:text-black"},ht=o("span",{class:"md:hidden"},"ID:",-1),gt={class:"-ml-2 self-center"},bt=["innerHTML"],xt={key:1},wt={class:"self-center"},kt={class:"items-center flex"},$t={class:"self-center md:text-right"},St={key:0,class:"md:col-span-5 border-t italic text-gray-300 text-center"},Mt=F({__name:"search",setup(a){const t=le();let v=String(t.query.q||"");const n=x(null);let s=x(!0),i=x(Se);const h=(l,u=!1)=>{const k=[];Object.entries(l).forEach(([D,$])=>{$&&$.length!=0&&k.push(D+":=[`"+$.join("`,`")+"`]")});const w=k.join("&&");return u?encodeURIComponent(w).replace("=",""):w},_=(l,u=!1)=>{const w=(u?decodeURIComponent(l):l).split("&&"),D={...i.value};return w.forEach($=>{var T;const O=$.split(":=");D[O[0]]=JSON.parse((T=String(O[1]))==null?void 0:T.replaceAll("`",'"'))}),D},c=l=>{switch(t.query.sort_by){case`${l}:asc`:return`${l}:desc`;case`${l}:desc`:return"";default:return`${l}:asc`}};t.query.facets&&(i.value=_(String(t.query.facets),!0));const y=async(l="",u=1,k=25,w="",D="")=>{s.value=!0;const $=await xe({q:l,query_by:"edition-name",per_page:k,page:u,facet_by:Object.keys(i.value).join(","),filter_by:w,sort_by:D});n.value=$,s.value=!1},d=j(()=>Number(t.query.page)||1),p=j(()=>Number(t.query.limit)||25);return he(t,l=>{const u=l.query;y(String(u.q||""),d.value||1,p.value||25,decodeURIComponent(String(u.facets||"")),String(u.sort_by||""))},{immediate:!0}),(l,u)=>{var O,T,Q,J,W,X,Y,G,Z;const k=pe,w=fe,D=We,$=Ce;return r(),m("div",null,[g(w,null,{default:q(()=>[g(k,null,{default:q(()=>[N("Browse Editions")]),_:1})]),_:1}),o("div",tt,[ae(o("input",{type:"search","onUpdate:modelValue":u[0]||(u[0]=f=>ne(v)?v.value=f:v=f),onInput:u[1]||(u[1]=f=>l.$router.replace({query:{...e(t).query,q:e(v),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow-md",placeholder:"Search..."},null,544),[[ge,e(v)]])]),o("div",st,[g(e(Ge),{as:"div",class:"flex flex-col md:pt-10"},{default:q(({open:f})=>[g(e(Ze),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:q(()=>[N(b(f?"Hide":"Show")+" Filters... ",1),g(e(E),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),g(e(et),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:q(()=>{var P;return[e(s)?I("",!0):(r(!0),m(H,{key:0},z(((P=e(n))==null?void 0:P.facet_counts).sort((S,U)=>e(i)[U.field_name].length-e(i)[S.field_name].length),S=>(r(),C(D,{class:"pt-2","field-name":S.field_name,facets:S.counts,selected:e(i)[S.field_name],onFacetChange:U=>{e(i)[S.field_name]=U,l.$router.push({query:{...e(t).query,facets:h(e(i),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),e(s)||!((O=e(n))!=null&&O.found)?(r(),C(Ne,{key:0,class:"-z-10"},{default:q(()=>[e(s)?(r(),C(e(qe),{key:0,class:"h-5 w-5 animate-spin"})):(r(),m("span",lt,"Nothing found."))]),_:1})):(r(),m("div",at,[o("div",nt,[o("button",{class:V(["rounded border p-4 transition",e(d)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(d)<=1,onClick:u[2]||(u[2]=f=>l.$router.push({query:{...e(t).query,page:e(d)-1}}))},[rt,g(e(E),{class:"h-4 w-4 -rotate-90"})],10,ot),o("span",null," showing "+b((e(d)-1)*e(p)+1)+" - "+b(Math.min(((T=e(n))==null?void 0:T.found)||1/0,e(d)*e(p)))+" out of "+b((Q=e(n))==null?void 0:Q.found),1),o("button",{class:V(["rounded border p-4 transition",e(d)*e(p)>=Number((J=e(n))==null?void 0:J.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(d)*e(p)>=Number((W=e(n))==null?void 0:W.found),onClick:u[3]||(u[3]=f=>l.$router.push({query:{...e(t).query,page:e(d)+1}}))},[ut,g(e(E),{class:"h-4 w-4 rotate-90"})],10,it)]),!e(s)&&((X=e(n))!=null&&X.found)?(r(),m("div",ct,[o("div",null,[o("div",dt,[N(" ID "),e(t).query.sort_by?I("",!0):(r(),C(e(E),{key:0,class:"w-4 h-4 rotate-180 opacity-50"}))])]),o("div",null,[g($,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...e(t).query,page:1,sort_by:c("edition-name")}}},{default:q(()=>{var f;return[N(" Name "),e(t).query.sort_by&&e(t).query.sort_by.includes("edition-name")?(r(),C(e(E),{key:0,class:V([{"rotate-180":!((f=e(t).query.sort_by)!=null&&f.includes("desc"))},"w-4 h-4"])},null,8,["class"])):(r(),C(e(Pe),{key:1,class:"w-5 h-5 opacity-50"})),pt]}),_:1},8,["to"])]),ft,mt,_t,(r(!0),m(H,null,z((Y=e(n))==null?void 0:Y.hits,f=>(r(),m(H,null,[vt,o("div",yt,[ht,N(" "+b(f.document.id),1)]),o("div",gt,[g(je,{href:"/editions/"+f.document.id},{default:q(()=>{var P,S;return[(P=f.highlight["edition-name"])!=null&&P.snippet?(r(),m("span",{key:0,innerHTML:(S=f.highlight["edition-name"])==null?void 0:S.snippet},null,8,bt)):(r(),m("span",xt,b(f.document["edition-name"]),1))]}),_:2},1032,["href"])]),o("div",wt,[g(De,{institutions:f.document["institution-s"],"no-icons":""},null,8,["institutions"])]),o("div",kt,[g(ee,{class:"hidden md:flex text-black",href:f.document.url,"icon-only":""},null,8,["href"]),g(ee,{class:"md:hidden",href:f.document.url},null,8,["href"])]),o("div",$t,b(f.document["time-century"]),1)],64))),256)),Math.min(((G=e(n))==null?void 0:G.found)||1/0,e(d)*e(p))===((Z=e(n))==null?void 0:Z.found)?(r(),m("div",St," You've reached the end. ")):I("",!0)])):I("",!0)]))])])}}});export{Mt as default};
