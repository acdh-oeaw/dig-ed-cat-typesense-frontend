import{T as pe,H as fe}from"./components.5a5a48e3.js";import{o as v,c as m,a as c,_ as ve,z as ne,f as P,r as _,t as x,h as a,F as H,m as V,g as le,A as me,B as C,d as D,b as g,w as $,i as F,l as R,C as he,D as ge,E as K,G as Q,s as W,H as se,n as N,I as ae,j as _e,v as ye,J as ee}from"./entry.5028898a.js";import{b as be,g as we}from"./use-data.674da7cc.js";import{k as xe,r as ke,_ as $e}from"./mapping-objects.56cb6cba.js";import{c as je}from"./centered.dc264585.js";import{_ as Se}from"./nuxt-link.cf0217af.js";import"./_commonjsHelpers.042e6b4d.js";import"./asyncData.45e4ce16.js";function Oe(e,l){return v(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[c("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function De(e,l){return v(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[c("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function q(e,l){return v(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[c("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ce={},Ee={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Pe(e,l){return v(),m("div",Ee,[ne(e.$slots,"default")])}const Te=ve(Ce,[["render",Pe]]),Be={class:"flex flex-col"},He={class:"flex items-center justify-between text-2xl"},Ae={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Me=["id","value"],Ne=["for"],Ie=P({__name:"facet-field",props:{facet:{},selected:{}},setup(e){const l=e;let s=_(l.selected),n=_(!1),t=_(l.facet);const f=async()=>{var o,i,d;n.value=!0;const r=await be(t.value.field_name);t.value=(i=(o=r.value)==null?void 0:o.facet_counts)!=null&&i.length?(d=r.value)==null?void 0:d.facet_counts[0]:[],n.value=!1};return(r,o)=>(v(),m("div",Be,[c("h1",He,x(a(xe)[a(t).field_name]),1),(v(!0),m(H,null,V(a(t).counts,i=>(v(),m("div",Ae,[le(c("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:i.value,value:i.value,onChange:o[0]||(o[0]=d=>r.$emit("facetChange",a(s))),"onUpdate:modelValue":o[1]||(o[1]=d=>C(s)?s.value=d:s=d)},null,40,Me),[[me,a(s)]]),D("   "),c("label",{for:i.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[D(x(i.value)+" ",1),g(Te,null,{default:$(()=>[D(x(i.count),1)]),_:2},1024)],8,Ne)]))),256)),a(t).stats.total_values!=a(t).counts.length?(v(),m("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:f},[c("span",null," show all... ("+x(a(t).stats.total_values)+" total)",1),g(a(Oe),{class:"h-5 w-5"})])):F("",!0)]))}}),Le={class:"text-right"},qe=P({__name:"internal-link",props:{href:{}},setup(e){return(l,s)=>{const n=Se;return v(),R(n,{href:l.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:$(()=>[c("span",null,[ne(l.$slots,"default",{},()=>[D(x(l.href),1)])]),D("   "),c("span",Le,[g(a(De),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});function I(e,l,...s){if(e in l){let t=l[e];return typeof t=="function"?t(...s):t}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(l).map(t=>`"${t}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,I),n}var z=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(z||{}),Ue=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Ue||{});function G({visible:e=!0,features:l=0,ourProps:s,theirProps:n,...t}){var f;let r=re(n,s),o=Object.assign(t,{props:r});if(e||l&2&&r.static)return U(o);if(l&1){let i=(f=r.unmount)==null||f?0:1;return I(i,{[0](){return null},[1](){return U({...t,props:{...r,hidden:!0,style:{display:"none"}}})}})}return U(o)}function U({props:e,attrs:l,slots:s,slot:n,name:t}){var f,r;let{as:o,...i}=Ve(e,["unmount","static"]),d=(f=s.default)==null?void 0:f.call(s,n),y={};if(n){let k=!1,u=[];for(let[b,w]of Object.entries(n))typeof w=="boolean"&&(k=!0),w===!0&&u.push(b);k&&(y["data-headlessui-state"]=u.join(" "))}if(o==="template"){if(d=oe(d??[]),Object.keys(i).length>0||Object.keys(l).length>0){let[k,...u]=d??[];if(!Fe(k)||u.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${t} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(i).concat(Object.keys(l)).map(p=>p.trim()).filter((p,S,M)=>M.indexOf(p)===S).sort((p,S)=>p.localeCompare(S)).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`));let b=re((r=k.props)!=null?r:{},i),w=he(k,b);for(let p in b)p.startsWith("on")&&(w.props||(w.props={}),w.props[p]=b[p]);return w}return Array.isArray(d)&&d.length===1?d[0]:d}return ge(o,Object.assign({},i,y),{default:()=>d})}function oe(e){return e.flatMap(l=>l.type===H?oe(l.children):[l])}function re(...e){if(e.length===0)return{};if(e.length===1)return e[0];let l={},s={};for(let n of e)for(let t in n)t.startsWith("on")&&typeof n[t]=="function"?(s[t]!=null||(s[t]=[]),s[t].push(n[t])):l[t]=n[t];if(l.disabled||l["aria-disabled"])return Object.assign(l,Object.fromEntries(Object.keys(s).map(n=>[n,void 0])));for(let n in s)Object.assign(l,{[n](t,...f){let r=s[n];for(let o of r){if(t instanceof Event&&t.defaultPrevented)return;o(t,...f)}}});return l}function Ve(e,l=[]){let s=Object.assign({},e);for(let n of l)n in s&&delete s[n];return s}function Fe(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let Re=0;function ze(){return++Re}function ie(){return ze()}var E=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(E||{});function j(e){var l;return e==null||e.value==null?null:(l=e.value.$el)!=null?l:e.value}let ue=Symbol("Context");var A=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(A||{});function Ke(){return K(ue,null)}function Qe(e){Q(ue,e)}function te(e,l){if(e)return e;let s=l??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function We(e,l){let s=_(te(e.value.type,e.value.as));return W(()=>{s.value=te(e.value.type,e.value.as)}),se(()=>{var n;s.value||j(l)&&j(l)instanceof HTMLButtonElement&&!((n=j(l))!=null&&n.hasAttribute("type"))&&(s.value="button")}),s}var Ge=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ge||{});let ce=Symbol("DisclosureContext");function J(e){let l=K(ce,null);if(l===null){let s=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,J),s}return l}let de=Symbol("DisclosurePanelContext");function Je(){return K(de,null)}let Xe=P({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:l,attrs:s}){let n=_(e.defaultOpen?0:1),t=_(null),f=_(null),r={buttonId:_(null),panelId:_(null),disclosureState:n,panel:t,button:f,toggleDisclosure(){n.value=I(n.value,{[0]:1,[1]:0})},closeDisclosure(){n.value!==1&&(n.value=1)},close(o){r.closeDisclosure();let i=(()=>o?o instanceof HTMLElement?o:o.value instanceof HTMLElement?j(o):j(r.button):j(r.button))();i==null||i.focus()}};return Q(ce,r),Qe(N(()=>I(n.value,{[0]:A.Open,[1]:A.Closed}))),()=>{let{defaultOpen:o,...i}=e,d={open:n.value===0,close:r.close};return G({theirProps:i,ourProps:{},slot:d,slots:l,attrs:s,name:"Disclosure"})}}}),Ye=P({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ie()}`}},setup(e,{attrs:l,slots:s,expose:n}){let t=J("DisclosureButton");W(()=>{t.buttonId.value=e.id}),ae(()=>{t.buttonId.value=null});let f=Je(),r=N(()=>f===null?!1:f.value===t.panelId.value),o=_(null);n({el:o,$el:o}),r.value||se(()=>{t.button.value=o.value});let i=We(N(()=>({as:e.as,type:l.type})),o);function d(){var u;e.disabled||(r.value?(t.toggleDisclosure(),(u=j(t.button))==null||u.focus()):t.toggleDisclosure())}function y(u){var b;if(!e.disabled)if(r.value)switch(u.key){case E.Space:case E.Enter:u.preventDefault(),u.stopPropagation(),t.toggleDisclosure(),(b=j(t.button))==null||b.focus();break}else switch(u.key){case E.Space:case E.Enter:u.preventDefault(),u.stopPropagation(),t.toggleDisclosure();break}}function k(u){switch(u.key){case E.Space:u.preventDefault();break}}return()=>{let u={open:t.disclosureState.value===0},{id:b,...w}=e,p=r.value?{ref:o,type:i.value,onClick:d,onKeydown:y}:{id:b,ref:o,type:i.value,"aria-expanded":e.disabled?void 0:t.disclosureState.value===0,"aria-controls":j(t.panel)?t.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:d,onKeydown:y,onKeyup:k};return G({ourProps:p,theirProps:w,slot:u,attrs:l,slots:s,name:"DisclosureButton"})}}}),Ze=P({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ie()}`}},setup(e,{attrs:l,slots:s,expose:n}){let t=J("DisclosurePanel");W(()=>{t.panelId.value=e.id}),ae(()=>{t.panelId.value=null}),n({el:t.panel,$el:t.panel}),Q(de,t.panelId);let f=Ke(),r=N(()=>f!==null?(f.value&A.Open)===A.Open:t.disclosureState.value===0);return()=>{let o={open:t.disclosureState.value===0,close:t.close},{id:i,...d}=e,y={id:i,ref:t.panel};return G({ourProps:y,theirProps:d,slot:o,attrs:l,slots:s,features:z.RenderStrategy|z.Static,visible:r.value,name:"DisclosurePanel"})}}});const et={class:"mx-auto flex max-w-container items-center px-2"},tt={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},nt={key:1,class:"min-w-full"},lt={class:"my-2 flex items-center justify-between"},st=["disabled"],at=c("span",{class:"sr-only"},"Previous Page",-1),ot=["disabled"],rt=c("span",{class:"sr-only"},"Next Page",-1),it={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},ut=c("div",null,"Name",-1),ct=c("div",null,"Institution(s)",-1),dt=c("div",null,"url",-1),pt=c("div",{class:"text-right"},"time",-1),ft=c("div",{class:"col-span-4 border-t"},null,-1),vt={class:"-ml-2 self-center"},mt=["innerHTML"],ht={key:1},gt={class:"self-center"},_t={class:"flex items-center"},yt={class:"self-center text-right"},Dt=P({__name:"search",setup(e){const l=_e();let s=String(l.query.q||""),n=Number(l.query.page||1),t=Number(l.query.limit||25),f=String(l.query.inst||""),r=_(null),o=_(!0),i=_({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":f?[f]:[]});const d=k=>{const u=[];return Object.entries(k).forEach(([w,p])=>{p&&p.length!=0&&u.push(p.map(S=>`${w}:="${S}"`).join("&&"))}),u.join(" && ")},y=async()=>{o.value=!0,console.log("input",s),r=_(await we({q:s,query_by:"edition-name",per_page:25,page:n,facet_by:Object.keys(i.value).join(","),filter_by:d(i.value)})),o.value=!1};return y(),(k,u)=>{var S,M,X,Y,Z;const b=pe,w=fe,p=Ie;return v(),m("div",null,[g(w,null,{default:$(()=>[g(b,null,{default:$(()=>[D("Browse Editions")]),_:1})]),_:1}),c("div",et,[le(c("input",{type:"search","onUpdate:modelValue":u[0]||(u[0]=h=>C(s)?s.value=h:s=h),onInput:u[1]||(u[1]=h=>{C(n)?n.value=1:n=1,y()}),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[ye,a(s)]])]),c("div",null,[c("div",tt,[g(a(Xe),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:$(({open:h})=>[g(a(Ye),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:$(()=>[D(x(h?"Hide":"Show")+" Filters... ",1),g(a(q),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),g(a(Ze),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:$(()=>{var O,T;return[a(o)?F("",!0):(v(!0),m(H,{key:0},V((T=(O=a(r))==null?void 0:O.facet_counts)==null?void 0:T.sort((B,L)=>a(i)[L.field_name].length-a(i)[B.field_name].length),B=>(v(),R(p,{class:"pt-2",facet:B,selected:a(i)[B.field_name],onFacetChange:L=>{a(i)[B.field_name]=L,C(n)?n.value=1:n=1,y()}},null,8,["facet","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),a(o)?(v(),R(je,{key:0,class:"-z-10"},{default:$(()=>[g(a(ke),{class:"h-5 w-5 animate-spin"})]),_:1})):(v(),m("div",nt,[c("div",lt,[c("button",{class:ee(["rounded border p-4 transition",a(n)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(n)<=1,onClick:u[2]||(u[2]=h=>{C(n)?n.value--:n--,y()})},[at,g(a(q),{class:"h-4 w-4 -rotate-90"})],10,st),c("span",null," showing "+x((a(n)-1)*a(t)+1)+" - "+x(Math.min(((S=a(r))==null?void 0:S.found)||1/0,a(n)*a(t)))+" out of "+x((M=a(r))==null?void 0:M.found),1),c("button",{class:ee(["rounded border p-4 transition",a(n)*a(t)>=Number((X=a(r))==null?void 0:X.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(n)*a(t)>=Number((Y=a(r))==null?void 0:Y.found),onClick:u[3]||(u[3]=h=>{C(n)?n.value++:n++,y()})},[rt,g(a(q),{class:"h-4 w-4 rotate-90"})],10,ot)]),a(o)?F("",!0):(v(),m("div",it,[ut,ct,dt,pt,(v(!0),m(H,null,V((Z=a(r))==null?void 0:Z.hits,h=>(v(),m(H,null,[ft,c("div",vt,[g(qe,{href:"/editions/"+h.document.id},{default:$(()=>{var O,T;return[(O=h.highlight["edition-name"])!=null&&O.snippet?(v(),m("span",{key:0,innerHTML:(T=h.highlight["edition-name"])==null?void 0:T.snippet},null,8,mt)):(v(),m("span",ht,x(h.document["edition-name"]),1))]}),_:2},1032,["href"])]),c("div",gt,x(h.document["institution-s"].map(O=>O["institution-name"]).join(", ")),1),c("div",_t,[g($e,{href:h.document.url,"icon-only":""},null,8,["href"])]),c("div",yt,x(h.document["time-century"]),1)],64))),256))]))]))])])])}}});export{Dt as default};
