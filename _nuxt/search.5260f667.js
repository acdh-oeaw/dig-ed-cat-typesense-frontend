import{T as _e,H as ve}from"./components.127f9367.js";import{o,c as p,a,_ as he,H as ne,f as M,l as ae,r as x,D as A,B,t as w,i as e,F as H,j as R,g as oe,I as ye,J as re,d as D,k as j,w as k,h as O,b,K as ie,s as ue,L as ge,M as ce,x as be,v as we,N as z}from"./entry.79950c16.js";import{b as xe,g as ke}from"./use-data.54fa216b.js";import{k as $e,p as Se,a as qe,e as De,r as Ce,_ as te}from"./types.832220f4.js";import{_ as de}from"./nuxt-link.0e77c47c.js";import{c as Ne}from"./centered.ad19a50d.js";import{u as se,o as T,c as je,l as U,H as K,t as pe,b as Be,p as Ie,N as le,a as L}from"./use-resolve-button-type.57ae4d64.js";import"./_commonjsHelpers.042e6b4d.js";function Oe(l,t){return o(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Te(l,t){return o(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function Me(l,t){return o(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function F(l,t){return o(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[a("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Pe={},Ee={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Le(l,t){return o(),p("div",Ee,[ne(l.$slots,"default")])}const Fe=he(Pe,[["render",Le]]),He=(l,t)=>l.filter((f,n,s)=>n===s.findIndex(r=>r[t]===f[t])),Ue=l=>l.charAt(0).toUpperCase()+l.slice(1),Ve={class:"flex flex-col"},ze={class:"flex items-center justify-between text-2xl"},Re={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ae=["id","value"],Ke=["for"],Qe={key:0},We={key:1},Je=M({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(l){const t=l,f=ae();console.log("query",f.query);let n=x(t.selected),s=x(!0),r=x({field_name:t.fieldName,counts:[],stats:{}});const g=async(u=500,y="")=>{var d;s.value=!0;const c=await xe(t.fieldName,u,f.query);r.value=(d=c.facet_counts)!=null&&d.length?c.facet_counts[0]:{},s.value=!1};A(async()=>{await g(10)});const h=B(()=>{let u=He([...r.value.counts,...t.facets],"value");return u=u.sort(y=>t.selected&&t.selected.includes(y.value)?-1:1),u});return(u,y)=>{var c;return o(),p("div",Ve,[a("h1",ze,w(e($e)[u.fieldName]),1),(o(!0),p(H,null,R(h.value,d=>(o(),p("div",Re,[oe(a("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:`${u.fieldName}:${d.value}`,value:d.value,onChange:y[0]||(y[0]=m=>u.$emit("facetChange",e(n))),"onUpdate:modelValue":y[1]||(y[1]=m=>re(n)?n.value=m:n=m)},null,40,Ae),[[ye,e(n)]]),D("   "),a("label",{for:`${u.fieldName}:${d.value}`,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[e(Se).includes(d.value)?(o(),p("span",Qe,w(e(Ue)(e(qe)[d.value])),1)):(o(),p("span",We,w(d.value),1)),d.count?(o(),j(Fe,{key:2},{default:k(()=>[D(w(d.count),1)]),_:2},1024)):O("",!0)],8,Ke)]))),256)),((c=e(r).stats)==null?void 0:c.total_values)!=e(r).counts.length?(o(),p("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:y[2]||(y[2]=d=>g())},[a("span",null,"show all... ("+w(e(r).stats.total_values)+" total)",1),b(e(Oe),{class:"h-5 w-5"})])):O("",!0)])}}}),Xe={class:"text-right"},Ye=M({__name:"internal-link",props:{href:{}},setup(l){return(t,f)=>{const n=de;return o(),j(n,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:k(()=>[a("span",null,[ne(t.$slots,"default",{},()=>[D(w(t.href),1)])]),D("   "),a("span",Xe,[b(e(Te),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});var Ge=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(Ge||{});let fe=Symbol("DisclosureContext");function Q(l){let t=ce(fe,null);if(t===null){let f=new Error(`<${l} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(f,Q),f}return t}let me=Symbol("DisclosurePanelContext");function Ze(){return ce(me,null)}let et=M({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(l,{slots:t,attrs:f}){let n=x(l.defaultOpen?0:1),s=x(null),r=x(null),g={buttonId:x(null),panelId:x(null),disclosureState:n,panel:s,button:r,toggleDisclosure(){n.value=se(n.value,{[0]:1,[1]:0})},closeDisclosure(){n.value!==1&&(n.value=1)},close(h){g.closeDisclosure();let u=(()=>h?h instanceof HTMLElement?h:h.value instanceof HTMLElement?T(h):T(g.button):T(g.button))();u==null||u.focus()}};return ie(fe,g),je(B(()=>se(n.value,{[0]:U.Open,[1]:U.Closed}))),()=>{let{defaultOpen:h,...u}=l,y={open:n.value===0,close:g.close};return K({theirProps:u,ourProps:{},slot:y,slots:t,attrs:f,name:"Disclosure"})}}}),tt=M({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${pe()}`}},setup(l,{attrs:t,slots:f,expose:n}){let s=Q("DisclosureButton");A(()=>{s.buttonId.value=l.id}),ue(()=>{s.buttonId.value=null});let r=Ze(),g=B(()=>r===null?!1:r.value===s.panelId.value),h=x(null);n({el:h,$el:h}),g.value||ge(()=>{s.button.value=h.value});let u=Be(B(()=>({as:l.as,type:t.type})),h);function y(){var m;l.disabled||(g.value?(s.toggleDisclosure(),(m=T(s.button))==null||m.focus()):s.toggleDisclosure())}function c(m){var i;if(!l.disabled)if(g.value)switch(m.key){case L.Space:case L.Enter:m.preventDefault(),m.stopPropagation(),s.toggleDisclosure(),(i=T(s.button))==null||i.focus();break}else switch(m.key){case L.Space:case L.Enter:m.preventDefault(),m.stopPropagation(),s.toggleDisclosure();break}}function d(m){switch(m.key){case L.Space:m.preventDefault();break}}return()=>{let m={open:s.disclosureState.value===0},{id:i,..._}=l,$=g.value?{ref:h,type:u.value,onClick:y,onKeydown:c}:{id:i,ref:h,type:u.value,"aria-expanded":l.disabled?void 0:s.disclosureState.value===0,"aria-controls":T(s.panel)?s.panelId.value:void 0,disabled:l.disabled?!0:void 0,onClick:y,onKeydown:c,onKeyup:d};return K({ourProps:$,theirProps:_,slot:m,attrs:t,slots:f,name:"DisclosureButton"})}}}),st=M({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${pe()}`}},setup(l,{attrs:t,slots:f,expose:n}){let s=Q("DisclosurePanel");A(()=>{s.panelId.value=l.id}),ue(()=>{s.panelId.value=null}),n({el:s.panel,$el:s.panel}),ie(me,s.panelId);let r=Ie(),g=B(()=>r!==null?(r.value&U.Open)===U.Open:s.disclosureState.value===0);return()=>{let h={open:s.disclosureState.value===0,close:s.close},{id:u,...y}=l,c={id:u,ref:s.panel};return K({ourProps:c,theirProps:y,slot:h,attrs:t,slots:f,features:le.RenderStrategy|le.Static,visible:g.value,name:"DisclosurePanel"})}}});const lt={class:"mx-auto flex max-w-container items-center p-2 md:p-0"},nt={class:"grid min-w-full h-full gap-4 divide-y md:divide-y-0 p-4 grid-rows-[auto_1fr] md:grid-rows-1 md:grid-cols-[1fr_4fr] 2xl:grid-cols-[1fr_3fr_1fr] 2xl:gap-32 2xl:divide-y-0 2xl:px-16"},at={key:1,class:"text-gray-400 italic"},ot={key:1,class:"w-full max-w-container mx-auto"},rt={class:"my-2 flex items-center justify-between"},it=["disabled"],ut=a("span",{class:"sr-only"},"Previous Page",-1),ct=["disabled"],dt=a("span",{class:"sr-only"},"Next Page",-1),pt={key:0,class:"grid min-w-full grid-cols-1 md:grid-cols-[auto_5fr_3fr_auto_auto] gap-x-8 gap-y-1"},ft={class:"hidden items-center gap-2 p-1 -m-1 md:flex"},mt=a("span",{class:"sr-only"},"Click to sort by Name",-1),_t=a("div",{class:"hidden md:block"},"Institution(s)",-1),vt=a("div",{class:"hidden md:block"},"url",-1),ht=a("div",{class:"text-right hidden md:block"},"Time",-1),yt=a("div",{class:"md:col-span-5 border-t"},null,-1),gt={class:"self-center text-gray-500 text-sm md:text-base md:text-black"},bt=a("span",{class:"md:hidden"},"ID:",-1),wt={class:"-ml-2 self-center"},xt=["innerHTML"],kt={key:1},$t={class:"self-center"},St={class:"items-center flex"},qt={class:"self-center md:text-right"},Dt={key:0,class:"md:col-span-5 border-t italic text-gray-300 text-center"},Pt=M({__name:"search",setup(l){const t=ae();let f=String(t.query.q||"");const n=x(null);let s=x(!0),r=x(De);const g=(i,_=!1)=>{const $=[];Object.entries(i).forEach(([N,S])=>{S&&S.length!=0&&$.push(N+":=[`"+S.join("`,`")+"`]")});const C=$.join("&&");return _?encodeURIComponent(C).replace("=",""):C},h=(i,_=!1)=>{const C=(_?decodeURIComponent(i):i).split("&&"),N={...r.value};return C.forEach(S=>{var E;const P=S.split(":=");N[P[0]]=JSON.parse((E=String(P[1]))==null?void 0:E.replaceAll("`",'"'))}),N},u=i=>{switch(t.query.sort_by){case`${i}:asc`:return`${i}:desc`;case`${i}:desc`:return"";default:return`${i}:asc`}};t.query.facets&&(r.value=h(String(t.query.facets),!0));const y=async(i="",_=1,$=25,C="",N="")=>{s.value=!0;const S=await ke({q:i,query_by:"edition-name",per_page:$,page:_,facet_by:Object.keys(r.value).join(","),filter_by:C,sort_by:N});n.value=S,s.value=!1},c=B(()=>Number(t.query.page)||1),d=B(()=>Number(t.query.limit)||25),m=B(()=>window.innerWidth);return be(t,i=>{const _=i.query;y(String(_.q||""),c.value||1,d.value||25,decodeURIComponent(String(_.facets||"")),String(_.sort_by||""))},{immediate:!0}),(i,_)=>{var P,E,W,J,X,Y,G,Z,ee;const $=_e,C=ve,N=Je,S=de;return o(),p("div",null,[b(C,null,{default:k(()=>[b($,null,{default:k(()=>[D("Browse Editions")]),_:1})]),_:1}),a("div",lt,[oe(a("input",{type:"search","onUpdate:modelValue":_[0]||(_[0]=v=>re(f)?f.value=v:f=v),onInput:_[1]||(_[1]=v=>i.$router.replace({query:{...e(t).query,q:e(f),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow-md",placeholder:"Search..."},null,544),[[we,e(f)]])]),a("div",nt,[b(e(et),{as:"div",class:"flex flex-col pt-10","default-open":e(m)>768},{default:k(({open:v})=>[b(e(tt),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:k(()=>[D(w(v?"Hide":"Show")+" Filters... ",1),b(e(F),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),b(e(st),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:k(()=>{var I;return[e(s)?O("",!0):(o(!0),p(H,{key:0},R(((I=e(n))==null?void 0:I.facet_counts).sort((q,V)=>e(r)[V.field_name].length-e(r)[q.field_name].length),q=>(o(),j(N,{class:"pt-2","field-name":q.field_name,facets:q.counts,selected:e(r)[q.field_name],onFacetChange:V=>{e(r)[q.field_name]=V,i.$router.push({query:{...e(t).query,facets:g(e(r),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1},8,["default-open"]),e(s)||!((P=e(n))!=null&&P.found)?(o(),j(Ne,{key:0,class:"-z-10"},{default:k(()=>[e(s)?(o(),j(e(Ce),{key:0,class:"h-5 w-5 animate-spin"})):(o(),p("span",at,"Nothing found."))]),_:1})):(o(),p("div",ot,[a("div",rt,[a("button",{class:z(["rounded border p-4 transition",e(c)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(c)<=1,onClick:_[2]||(_[2]=v=>i.$router.push({query:{...e(t).query,page:e(c)-1}}))},[ut,b(e(F),{class:"h-4 w-4 -rotate-90"})],10,it),a("span",null," showing "+w((e(c)-1)*e(d)+1)+" - "+w(Math.min(((E=e(n))==null?void 0:E.found)||1/0,e(c)*e(d)))+" out of "+w((W=e(n))==null?void 0:W.found),1),a("button",{class:z(["rounded border p-4 transition",e(c)*e(d)>=Number((J=e(n))==null?void 0:J.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:e(c)*e(d)>=Number((X=e(n))==null?void 0:X.found),onClick:_[3]||(_[3]=v=>i.$router.push({query:{...e(t).query,page:e(c)+1}}))},[dt,b(e(F),{class:"h-4 w-4 rotate-90"})],10,ct)]),!e(s)&&((Y=e(n))!=null&&Y.found)?(o(),p("div",pt,[a("div",null,[a("div",ft,[D(" ID "),e(t).query.sort_by?O("",!0):(o(),j(e(F),{key:0,class:"w-4 h-4 rotate-180 opacity-50"}))])]),a("div",null,[b(S,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...e(t).query,page:1,sort_by:u("edition-name")}}},{default:k(()=>{var v;return[D(" Name "),e(t).query.sort_by&&e(t).query.sort_by.includes("edition-name")?(o(),j(e(F),{key:0,class:z([{"rotate-180":!((v=e(t).query.sort_by)!=null&&v.includes("desc"))},"w-4 h-4"])},null,8,["class"])):(o(),j(e(Me),{key:1,class:"w-5 h-5 opacity-50"})),mt]}),_:1},8,["to"])]),_t,vt,ht,(o(!0),p(H,null,R((G=e(n))==null?void 0:G.hits,v=>(o(),p(H,null,[yt,a("div",gt,[bt,D(" "+w(v.document.id),1)]),a("div",wt,[b(Ye,{href:"/editions/"+v.document.id},{default:k(()=>{var I,q;return[(I=v.highlight["edition-name"])!=null&&I.snippet?(o(),p("span",{key:0,innerHTML:(q=v.highlight["edition-name"])==null?void 0:q.snippet},null,8,xt)):(o(),p("span",kt,w(v.document["edition-name"]),1))]}),_:2},1032,["href"])]),a("div",$t,w(v.document["institution-s"].map(I=>I["institution-name"]).join(", ")),1),a("div",St,[b(te,{class:"hidden md:flex",href:v.document.url,"icon-only":""},null,8,["href"]),b(te,{class:"md:hidden",href:v.document.url},null,8,["href"])]),a("div",qt,w(v.document["time-century"]),1)],64))),256)),Math.min(((Z=e(n))==null?void 0:Z.found)||1/0,e(c)*e(d))===((ee=e(n))==null?void 0:ee.found)?(o(),p("div",Dt," You've reached the end. ")):O("",!0)])):O("",!0)]))])])}}});export{Pt as default};
