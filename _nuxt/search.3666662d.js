import{T as ye,H as _e}from"./components.c55f65d4.js";import{o as v,c as y,a as i,_ as be,H as oe,f as T,r as x,D as R,B as N,t as $,i as s,F as M,j as K,g as re,I as we,J as ie,d as D,k as E,w as j,h as A,b as w,K as xe,L as ke,M as W,N as J,O as ue,s as ce,l as $e,x as Se,v as je,P as V}from"./entry.7107625c.js";import{b as Oe,g as Ce}from"./use-data.1b76eb83.js";import{k as De,r as qe,_ as Ee}from"./mapping-objects.57bfa574.js";import{_ as de}from"./nuxt-link.6f09b65d.js";import{c as Ne}from"./centered.effca62d.js";import"./_commonjsHelpers.042e6b4d.js";function Pe(e,t){return v(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Te(e,t){return v(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function Be(e,t){return v(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function L(e,t){return v(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ie={},Me={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Ae(e,t){return v(),y("div",Me,[oe(e.$slots,"default")])}const He=be(Ie,[["render",Ae]]),Le=(e,t)=>e.filter((a,l,n)=>l===n.findIndex(u=>u[t]===a[t])),Ue={class:"flex flex-col"},Re={class:"flex items-center justify-between text-2xl"},Fe={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},Ve=["id","value"],ze=["for"],Ke=T({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(e){const t=e;let a=x(t.selected),l=x(!0),n=x({field_name:t.fieldName,counts:[],stats:{}});const u=async(r=500,p="")=>{var c;l.value=!0;const m=await Oe(t.fieldName,r);n.value=(c=m.facet_counts)!=null&&c.length?m.facet_counts[0]:{},l.value=!1};R(async()=>{await u(10)});const f=N(()=>{let r=Le([...n.value.counts,...t.facets],"value");return r=r.sort(p=>t.selected&&t.selected.includes(p.value)?-1:1),r});return(r,p)=>{var m;return v(),y("div",Ue,[i("h1",Re,$(s(De)[r.fieldName]),1),(v(!0),y(M,null,K(f.value,c=>(v(),y("div",Fe,[re(i("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:c.value,value:c.value,onChange:p[0]||(p[0]=h=>r.$emit("facetChange",s(a))),"onUpdate:modelValue":p[1]||(p[1]=h=>ie(a)?a.value=h:a=h)},null,40,Ve),[[we,s(a)]]),D("   "),i("label",{for:c.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[D($(c.value)+" ",1),c.count?(v(),E(He,{key:0},{default:j(()=>[D($(c.count),1)]),_:2},1024)):A("",!0)],8,ze)]))),256)),((m=s(n).stats)==null?void 0:m.total_values)!=s(n).counts.length?(v(),y("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:p[2]||(p[2]=c=>u())},[i("span",null,"show all... ("+$(s(n).stats.total_values)+" total)",1),w(s(Pe),{class:"h-5 w-5"})])):A("",!0)])}}}),Qe={class:"text-right"},We=T({__name:"internal-link",props:{href:{}},setup(e){return(t,a)=>{const l=de;return v(),E(l,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:j(()=>[i("span",null,[oe(t.$slots,"default",{},()=>[D($(t.href),1)])]),D("   "),i("span",Qe,[w(s(Te),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});function U(e,t,...a){if(e in t){let n=t[e];return typeof n=="function"?n(...a):n}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,U),l}var Q=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Q||{}),Je=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Je||{});function Y({visible:e=!0,features:t=0,ourProps:a,theirProps:l,...n}){var u;let f=fe(l,a),r=Object.assign(n,{props:f});if(e||t&2&&f.static)return z(r);if(t&1){let p=(u=f.unmount)==null||u?0:1;return U(p,{[0](){return null},[1](){return z({...n,props:{...f,hidden:!0,style:{display:"none"}}})}})}return z(r)}function z({props:e,attrs:t,slots:a,slot:l,name:n}){var u,f;let{as:r,...p}=Ye(e,["unmount","static"]),m=(u=a.default)==null?void 0:u.call(a,l),c={};if(l){let h=!1,o=[];for(let[d,b]of Object.entries(l))typeof b=="boolean"&&(h=!0),b===!0&&o.push(d);h&&(c["data-headlessui-state"]=o.join(" "))}if(r==="template"){if(m=pe(m??[]),Object.keys(p).length>0||Object.keys(t).length>0){let[h,...o]=m??[];if(!Xe(h)||o.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${n} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(p).concat(Object.keys(t)).map(g=>g.trim()).filter((g,k,S)=>S.indexOf(g)===k).sort((g,k)=>g.localeCompare(k)).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let d=fe((f=h.props)!=null?f:{},p),b=xe(h,d);for(let g in d)g.startsWith("on")&&(b.props||(b.props={}),b.props[g]=d[g]);return b}return Array.isArray(m)&&m.length===1?m[0]:m}return ke(r,Object.assign({},p,c),{default:()=>m})}function pe(e){return e.flatMap(t=>t.type===M?pe(t.children):[t])}function fe(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},a={};for(let l of e)for(let n in l)n.startsWith("on")&&typeof l[n]=="function"?(a[n]!=null||(a[n]=[]),a[n].push(l[n])):t[n]=l[n];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(a).map(l=>[l,void 0])));for(let l in a)Object.assign(t,{[l](n,...u){let f=a[l];for(let r of f){if(n instanceof Event&&n.defaultPrevented)return;r(n,...u)}}});return t}function Ye(e,t=[]){let a=Object.assign({},e);for(let l of t)l in a&&delete a[l];return a}function Xe(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let Ge=0;function Ze(){return++Ge}function ve(){return Ze()}var P=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(P||{});function C(e){var t;return e==null||e.value==null?null:(t=e.value.$el)!=null?t:e.value}let me=Symbol("Context");var H=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(H||{});function et(){return W(me,null)}function tt(e){J(me,e)}function ae(e,t){if(e)return e;let a=t??"button";if(typeof a=="string"&&a.toLowerCase()==="button")return"button"}function nt(e,t){let a=x(ae(e.value.type,e.value.as));return R(()=>{a.value=ae(e.value.type,e.value.as)}),ue(()=>{var l;a.value||C(t)&&C(t)instanceof HTMLButtonElement&&!((l=C(t))!=null&&l.hasAttribute("type"))&&(a.value="button")}),a}var st=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(st||{});let ge=Symbol("DisclosureContext");function X(e){let t=W(ge,null);if(t===null){let a=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,X),a}return t}let he=Symbol("DisclosurePanelContext");function lt(){return W(he,null)}let at=T({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:t,attrs:a}){let l=x(e.defaultOpen?0:1),n=x(null),u=x(null),f={buttonId:x(null),panelId:x(null),disclosureState:l,panel:n,button:u,toggleDisclosure(){l.value=U(l.value,{[0]:1,[1]:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(r){f.closeDisclosure();let p=(()=>r?r instanceof HTMLElement?r:r.value instanceof HTMLElement?C(r):C(f.button):C(f.button))();p==null||p.focus()}};return J(ge,f),tt(N(()=>U(l.value,{[0]:H.Open,[1]:H.Closed}))),()=>{let{defaultOpen:r,...p}=e,m={open:l.value===0,close:f.close};return Y({theirProps:p,ourProps:{},slot:m,slots:t,attrs:a,name:"Disclosure"})}}}),ot=T({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ve()}`}},setup(e,{attrs:t,slots:a,expose:l}){let n=X("DisclosureButton");R(()=>{n.buttonId.value=e.id}),ce(()=>{n.buttonId.value=null});let u=lt(),f=N(()=>u===null?!1:u.value===n.panelId.value),r=x(null);l({el:r,$el:r}),f.value||ue(()=>{n.button.value=r.value});let p=nt(N(()=>({as:e.as,type:t.type})),r);function m(){var o;e.disabled||(f.value?(n.toggleDisclosure(),(o=C(n.button))==null||o.focus()):n.toggleDisclosure())}function c(o){var d;if(!e.disabled)if(f.value)switch(o.key){case P.Space:case P.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure(),(d=C(n.button))==null||d.focus();break}else switch(o.key){case P.Space:case P.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure();break}}function h(o){switch(o.key){case P.Space:o.preventDefault();break}}return()=>{let o={open:n.disclosureState.value===0},{id:d,...b}=e,g=f.value?{ref:r,type:p.value,onClick:m,onKeydown:c}:{id:d,ref:r,type:p.value,"aria-expanded":e.disabled?void 0:n.disclosureState.value===0,"aria-controls":C(n.panel)?n.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:m,onKeydown:c,onKeyup:h};return Y({ourProps:g,theirProps:b,slot:o,attrs:t,slots:a,name:"DisclosureButton"})}}}),rt=T({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ve()}`}},setup(e,{attrs:t,slots:a,expose:l}){let n=X("DisclosurePanel");R(()=>{n.panelId.value=e.id}),ce(()=>{n.panelId.value=null}),l({el:n.panel,$el:n.panel}),J(he,n.panelId);let u=et(),f=N(()=>u!==null?(u.value&H.Open)===H.Open:n.disclosureState.value===0);return()=>{let r={open:n.disclosureState.value===0,close:n.close},{id:p,...m}=e,c={id:p,ref:n.panel};return Y({ourProps:c,theirProps:m,slot:r,attrs:t,slots:a,features:Q.RenderStrategy|Q.Static,visible:f.value,name:"DisclosurePanel"})}}});const it={class:"mx-auto flex max-w-container items-center px-2"},ut={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},ct={key:1,class:"text-gray-400 italic"},dt={key:1,class:"min-w-full"},pt={class:"my-2 flex items-center justify-between"},ft=["disabled"],vt=i("span",{class:"sr-only"},"Previous Page",-1),mt=["disabled"],gt=i("span",{class:"sr-only"},"Next Page",-1),ht={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},yt=i("span",{class:"sr-only"},"Click to sort by Name",-1),_t=i("div",null,"Institution(s)",-1),bt=i("div",null,"url",-1),wt=i("div",{class:"text-right"},"Time",-1),xt=i("div",{class:"col-span-4 border-t"},null,-1),kt={class:"-ml-2 self-center"},$t=["innerHTML"],St={key:1},jt={class:"self-center"},Ot={class:"flex items-center"},Ct={class:"self-center text-right"},Dt={key:0,class:"col-span-4 border-t italic text-gray-300 text-center"},Mt=T({__name:"search",setup(e){const t=$e();let a=String(t.query.q||"");const l=x(null);let n=x(!0),u=x({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":[]});const f=(o,d=!1)=>{const b=[];Object.entries(o).forEach(([k,S])=>{S&&S.length!=0&&b.push(k+":=[`"+S.join("`,`")+"`]")});const g=b.join("&&");return d?encodeURIComponent(g).replace("=",""):g},r=(o,d=!1)=>{const g=(d?decodeURIComponent(o):o).split("&&"),k={...u.value};return g.forEach(S=>{var I;const B=S.split(":=");k[B[0]]=JSON.parse((I=String(B[1]))==null?void 0:I.replaceAll("`",'"'))}),k},p=o=>{switch(t.query.sort_by){case`${o}:asc`:return`${o}:desc`;case`${o}:desc`:return"";default:return`${o}:asc`}};t.query.facets&&(u.value=r(String(t.query.facets),!0));const m=async(o="",d=1,b=25,g="",k="")=>{n.value=!0;const S=await Ce({q:o,query_by:"edition-name",per_page:b,page:d,facet_by:Object.keys(u.value).join(","),filter_by:g,sort_by:k});l.value=S,n.value=!1},c=N(()=>Number(t.query.page)||1),h=N(()=>Number(t.query.limit)||25);return Se(t,o=>{const d=o.query;m(String(d.q||""),c.value||1,h.value||25,decodeURIComponent(String(d.facets||"")),String(d.sort_by||""))},{immediate:!0}),(o,d)=>{var B,I,G,Z,ee,te,ne,se,le;const b=ye,g=_e,k=Ke,S=de;return v(),y("div",null,[w(g,null,{default:j(()=>[w(b,null,{default:j(()=>[D("Browse Editions")]),_:1})]),_:1}),i("div",it,[re(i("input",{type:"search","onUpdate:modelValue":d[0]||(d[0]=_=>ie(a)?a.value=_:a=_),onInput:d[1]||(d[1]=_=>o.$router.replace({query:{...s(t).query,q:s(a),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[je,s(a)]])]),i("div",null,[i("div",ut,[w(s(at),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:j(({open:_})=>[w(s(ot),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:j(()=>[D($(_?"Hide":"Show")+" Filters... ",1),w(s(L),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),w(s(rt),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:j(()=>{var q;return[s(n)?A("",!0):(v(!0),y(M,{key:0},K(((q=s(l))==null?void 0:q.facet_counts).sort((O,F)=>s(u)[F.field_name].length-s(u)[O.field_name].length),O=>(v(),E(k,{class:"pt-2","field-name":O.field_name,facets:O.counts,selected:s(u)[O.field_name],onFacetChange:F=>{s(u)[O.field_name]=F,o.$router.push({query:{...s(t).query,facets:f(s(u),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),s(n)||!((B=s(l))!=null&&B.found)?(v(),E(Ne,{key:0,class:"-z-10"},{default:j(()=>[s(n)?(v(),E(s(qe),{key:0,class:"h-5 w-5 animate-spin"})):(v(),y("span",ct,"Nothing found."))]),_:1})):(v(),y("div",dt,[i("div",pt,[i("button",{class:V(["rounded border p-4 transition",s(c)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:s(c)<=1,onClick:d[2]||(d[2]=_=>o.$router.push({query:{...s(t).query,page:s(c)-1}}))},[vt,w(s(L),{class:"h-4 w-4 -rotate-90"})],10,ft),i("span",null," showing "+$((s(c)-1)*s(h)+1)+" - "+$(Math.min(((I=s(l))==null?void 0:I.found)||1/0,s(c)*s(h)))+" out of "+$((G=s(l))==null?void 0:G.found),1),i("button",{class:V(["rounded border p-4 transition",s(c)*s(h)>=Number((Z=s(l))==null?void 0:Z.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:s(c)*s(h)>=Number((ee=s(l))==null?void 0:ee.found),onClick:d[3]||(d[3]=_=>o.$router.push({query:{...s(t).query,page:s(c)+1}}))},[gt,w(s(L),{class:"h-4 w-4 rotate-90"})],10,mt)]),!s(n)&&((te=s(l))!=null&&te.found)?(v(),y("div",ht,[i("div",null,[w(S,{class:"flex items-center gap-2 hover:bg-slate-200 p-1 -m-1 rounded transition active:bg-slate-300",to:{query:{...s(t).query,page:1,sort_by:p("edition-name")}}},{default:j(()=>{var _;return[D(" Name "),s(t).query.sort_by&&s(t).query.sort_by.includes("edition-name")?(v(),E(s(L),{key:0,class:V([{"rotate-180":!((_=s(t).query.sort_by)!=null&&_.includes("desc"))},"w-5 h-5"])},null,8,["class"])):(v(),E(s(Be),{key:1,class:"w-5 h-5 opacity-50"})),yt]}),_:1},8,["to"])]),_t,bt,wt,(v(!0),y(M,null,K((ne=s(l))==null?void 0:ne.hits,_=>(v(),y(M,null,[xt,i("div",kt,[w(We,{href:"/editions/"+_.document.id},{default:j(()=>{var q,O;return[(q=_.highlight["edition-name"])!=null&&q.snippet?(v(),y("span",{key:0,innerHTML:(O=_.highlight["edition-name"])==null?void 0:O.snippet},null,8,$t)):(v(),y("span",St,$(_.document["edition-name"]),1))]}),_:2},1032,["href"])]),i("div",jt,$(_.document["institution-s"].map(q=>q["institution-name"]).join(", ")),1),i("div",Ot,[w(Ee,{href:_.document.url,"icon-only":""},null,8,["href"])]),i("div",Ct,$(_.document["time-century"]),1)],64))),256)),Math.min(((se=s(l))==null?void 0:se.found)||1/0,s(c)*s(h))===((le=s(l))==null?void 0:le.found)?(v(),y("div",Dt," You've reached the end. ")):A("",!0)])):A("",!0)]))])])])}}});export{Mt as default};
