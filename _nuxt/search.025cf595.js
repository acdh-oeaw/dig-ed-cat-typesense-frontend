import{T as pe,H as fe}from"./components.92ef39cb.js";import{o as g,c as y,a as d,_ as ve,H as te,f as q,r as x,D as U,B as E,t as k,h as a,F as I,m as z,g as ne,I as me,J as le,d as C,l as H,w as S,i as M,b as w,K as ge,L as he,M as Q,N as W,O as se,s as ae,j as _e,x as ye,v as be,P as Z}from"./entry.c97237d3.js";import{b as we,g as xe}from"./use-data.1b76eb83.js";import{k as $e,r as ke,_ as Se}from"./mapping-objects.09b8afe2.js";import{c as je}from"./centered.61375900.js";import{_ as Oe}from"./nuxt-link.79dc8c37.js";import"./_commonjsHelpers.042e6b4d.js";function De(e,t){return g(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 011.06-1.06L12 14.69l6.97-6.97a.75.75 0 111.06 1.06l-7.5 7.5z","clip-rule":"evenodd"})])}function Ce(e,t){return g(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z","clip-rule":"evenodd"})])}function F(e,t){return g(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[d("path",{"fill-rule":"evenodd",d:"M11.47 7.72a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 01-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}const Ee={},Pe={class:"inline-block py-1 px-2 m-1 rounded-full bg-slate-100"};function Te(e,t){return g(),y("div",Pe,[te(e.$slots,"default")])}const qe=ve(Ee,[["render",Te]]),Ne=(e,t)=>e.filter((s,l,n)=>l===n.findIndex(u=>u[t]===s[t])),Be={class:"flex flex-col"},Ie={class:"flex items-center justify-between text-2xl"},Ae={class:"flex items-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300"},He=["id","value"],Me=["for"],Le=q({__name:"facet-field",props:{fieldName:{},facets:{},selected:{}},setup(e){const t=e;let s=x(t.selected),l=x(!0),n=x({field_name:t.fieldName,counts:[],stats:{}});const u=async(r=500,c="")=>{var v;l.value=!0;const i=await we(t.fieldName,r);n.value=(v=i.facet_counts)!=null&&v.length?i.facet_counts[0]:[],l.value=!1};U(async()=>{await u(10)});const p=E(()=>{let r=Ne([...n.value.counts,...t.facets],"value");return r=r.sort(c=>t.selected&&t.selected.includes(c.value)?-1:1),r});return(r,c)=>{var i;return g(),y("div",Be,[d("h1",Ie,k(a($e)[r.fieldName]),1),(g(!0),y(I,null,z(p.value,v=>(g(),y("div",Ae,[ne(d("input",{type:"checkbox",class:"h-5 w-5 cursor-pointer ml-1",id:v.value,value:v.value,onChange:c[0]||(c[0]=f=>r.$emit("facetChange",a(s))),"onUpdate:modelValue":c[1]||(c[1]=f=>le(s)?s.value=f:s=f)},null,40,He),[[me,a(s)]]),C("   "),d("label",{for:v.value,class:"flex w-full cursor-pointer items-center justify-between gap-1"},[C(k(v.value)+" ",1),v.count?(g(),H(qe,{key:0},{default:S(()=>[C(k(v.count),1)]),_:2},1024)):M("",!0)],8,Me)]))),256)),((i=a(n).stats)==null?void 0:i.total_values)!=a(n).counts.length?(g(),y("div",{key:0,class:"flex cursor-pointer items-center justify-center gap-2 rounded p-1 transition hover:bg-slate-200 active:bg-slate-300",onClick:c[2]||(c[2]=v=>u())},[d("span",null," show all... ("+k(a(n).stats.total_values)+" total)",1),w(a(De),{class:"h-5 w-5"})])):M("",!0)])}}}),Ue={class:"text-right"},Re=q({__name:"internal-link",props:{href:{}},setup(e){return(t,s)=>{const l=Oe;return g(),H(l,{href:t.href,class:"items-center grid grid-cols-[auto_auto_1fr] hover:bg-slate-200 active:bg-slate-300 p-2 rounded transition"},{default:S(()=>[d("span",null,[te(t.$slots,"default",{},()=>[C(k(t.href),1)])]),C("   "),d("span",Ue,[w(a(Ce),{class:"h-5 w-5 inline-block"})])]),_:3},8,["href"])}}});function L(e,t,...s){if(e in t){let n=t[e];return typeof n=="function"?n(...s):n}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,L),l}var K=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(K||{}),Fe=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Fe||{});function J({visible:e=!0,features:t=0,ourProps:s,theirProps:l,...n}){var u;let p=re(l,s),r=Object.assign(n,{props:p});if(e||t&2&&p.static)return V(r);if(t&1){let c=(u=p.unmount)==null||u?0:1;return L(c,{[0](){return null},[1](){return V({...n,props:{...p,hidden:!0,style:{display:"none"}}})}})}return V(r)}function V({props:e,attrs:t,slots:s,slot:l,name:n}){var u,p;let{as:r,...c}=Ve(e,["unmount","static"]),i=(u=s.default)==null?void 0:u.call(s,l),v={};if(l){let f=!1,o=[];for(let[h,_]of Object.entries(l))typeof _=="boolean"&&(f=!0),_===!0&&o.push(h);f&&(v["data-headlessui-state"]=o.join(" "))}if(r==="template"){if(i=oe(i??[]),Object.keys(c).length>0||Object.keys(t).length>0){let[f,...o]=i??[];if(!ze(f)||o.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${n} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(c).concat(Object.keys(t)).map(m=>m.trim()).filter((m,$,O)=>O.indexOf(m)===$).sort((m,$)=>m.localeCompare($)).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`));let h=re((p=f.props)!=null?p:{},c),_=ge(f,h);for(let m in h)m.startsWith("on")&&(_.props||(_.props={}),_.props[m]=h[m]);return _}return Array.isArray(i)&&i.length===1?i[0]:i}return he(r,Object.assign({},c,v),{default:()=>i})}function oe(e){return e.flatMap(t=>t.type===I?oe(t.children):[t])}function re(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},s={};for(let l of e)for(let n in l)n.startsWith("on")&&typeof l[n]=="function"?(s[n]!=null||(s[n]=[]),s[n].push(l[n])):t[n]=l[n];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(s).map(l=>[l,void 0])));for(let l in s)Object.assign(t,{[l](n,...u){let p=s[l];for(let r of p){if(n instanceof Event&&n.defaultPrevented)return;r(n,...u)}}});return t}function Ve(e,t=[]){let s=Object.assign({},e);for(let l of t)l in s&&delete s[l];return s}function ze(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let Ke=0;function Qe(){return++Ke}function ie(){return Qe()}var T=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(T||{});function j(e){var t;return e==null||e.value==null?null:(t=e.value.$el)!=null?t:e.value}let ue=Symbol("Context");var A=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(A||{});function We(){return Q(ue,null)}function Je(e){W(ue,e)}function ee(e,t){if(e)return e;let s=t??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function Xe(e,t){let s=x(ee(e.value.type,e.value.as));return U(()=>{s.value=ee(e.value.type,e.value.as)}),se(()=>{var l;s.value||j(t)&&j(t)instanceof HTMLButtonElement&&!((l=j(t))!=null&&l.hasAttribute("type"))&&(s.value="button")}),s}var Ye=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ye||{});let ce=Symbol("DisclosureContext");function X(e){let t=Q(ce,null);if(t===null){let s=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,X),s}return t}let de=Symbol("DisclosurePanelContext");function Ge(){return Q(de,null)}let Ze=q({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:t,attrs:s}){let l=x(e.defaultOpen?0:1),n=x(null),u=x(null),p={buttonId:x(null),panelId:x(null),disclosureState:l,panel:n,button:u,toggleDisclosure(){l.value=L(l.value,{[0]:1,[1]:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(r){p.closeDisclosure();let c=(()=>r?r instanceof HTMLElement?r:r.value instanceof HTMLElement?j(r):j(p.button):j(p.button))();c==null||c.focus()}};return W(ce,p),Je(E(()=>L(l.value,{[0]:A.Open,[1]:A.Closed}))),()=>{let{defaultOpen:r,...c}=e,i={open:l.value===0,close:p.close};return J({theirProps:c,ourProps:{},slot:i,slots:t,attrs:s,name:"Disclosure"})}}}),et=q({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-disclosure-button-${ie()}`}},setup(e,{attrs:t,slots:s,expose:l}){let n=X("DisclosureButton");U(()=>{n.buttonId.value=e.id}),ae(()=>{n.buttonId.value=null});let u=Ge(),p=E(()=>u===null?!1:u.value===n.panelId.value),r=x(null);l({el:r,$el:r}),p.value||se(()=>{n.button.value=r.value});let c=Xe(E(()=>({as:e.as,type:t.type})),r);function i(){var o;e.disabled||(p.value?(n.toggleDisclosure(),(o=j(n.button))==null||o.focus()):n.toggleDisclosure())}function v(o){var h;if(!e.disabled)if(p.value)switch(o.key){case T.Space:case T.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure(),(h=j(n.button))==null||h.focus();break}else switch(o.key){case T.Space:case T.Enter:o.preventDefault(),o.stopPropagation(),n.toggleDisclosure();break}}function f(o){switch(o.key){case T.Space:o.preventDefault();break}}return()=>{let o={open:n.disclosureState.value===0},{id:h,..._}=e,m=p.value?{ref:r,type:c.value,onClick:i,onKeydown:v}:{id:h,ref:r,type:c.value,"aria-expanded":e.disabled?void 0:n.disclosureState.value===0,"aria-controls":j(n.panel)?n.panelId.value:void 0,disabled:e.disabled?!0:void 0,onClick:i,onKeydown:v,onKeyup:f};return J({ourProps:m,theirProps:_,slot:o,attrs:t,slots:s,name:"DisclosureButton"})}}}),tt=q({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-disclosure-panel-${ie()}`}},setup(e,{attrs:t,slots:s,expose:l}){let n=X("DisclosurePanel");U(()=>{n.panelId.value=e.id}),ae(()=>{n.panelId.value=null}),l({el:n.panel,$el:n.panel}),W(de,n.panelId);let u=We(),p=E(()=>u!==null?(u.value&A.Open)===A.Open:n.disclosureState.value===0);return()=>{let r={open:n.disclosureState.value===0,close:n.close},{id:c,...i}=e,v={id:c,ref:n.panel};return J({ourProps:v,theirProps:i,slot:r,attrs:t,slots:s,features:K.RenderStrategy|K.Static,visible:p.value,name:"DisclosurePanel"})}}});const nt={class:"mx-auto flex max-w-container items-center px-2"},lt={class:"grid min-w-full gap-4 divide-y p-4 lg:grid-cols-[1fr_3fr_1fr] lg:gap-32 lg:divide-y-0 lg:px-16"},st={key:1,class:"min-w-full"},at={class:"my-2 flex items-center justify-between"},ot=["disabled"],rt=d("span",{class:"sr-only"},"Previous Page",-1),it=["disabled"],ut=d("span",{class:"sr-only"},"Next Page",-1),ct={key:0,class:"grid min-w-full grid-cols-[5fr_3fr_auto_auto] gap-x-8 gap-y-1"},dt=d("div",null,"Name",-1),pt=d("div",null,"Institution(s)",-1),ft=d("div",null,"url",-1),vt=d("div",{class:"text-right"},"time",-1),mt=d("div",{class:"col-span-4 border-t"},null,-1),gt={class:"-ml-2 self-center"},ht=["innerHTML"],_t={key:1},yt={class:"self-center"},bt={class:"flex items-center"},wt={class:"self-center text-right"},Ct=q({__name:"search",setup(e){const t=_e();let s=String(t.query.q||"");const l=x(null);let n=x(!0),u=x({"historical-period":[],language:[],"time-century":[],audience:[],"begin-date":[],"end-date":[],"institution-s.institution-name":[]});const p=(f,o=!1)=>{const h=[];Object.entries(f).forEach(([m,$])=>{$&&$.length!=0&&h.push(m+":=[`"+$.join("`,`")+"`]")});const _=h.join("&&");return o?encodeURIComponent(_).replace("=",""):_},r=(f,o=!1)=>{const _=(o?decodeURIComponent(f):f).split("&&"),m={...u.value};return _.forEach($=>{var N;const O=$.split(":=");m[O[0]]=JSON.parse((N=String(O[1]))==null?void 0:N.replaceAll("`",'"'))}),m};t.query.facets&&(u.value=r(String(t.query.facets),!0));const c=async(f="",o=1,h=25,_="")=>{n.value=!0;const m=await xe({q:f,query_by:"edition-name",per_page:h,page:o,facet_by:Object.keys(u.value).join(","),filter_by:_});l.value=m,n.value=!1},i=E(()=>Number(t.query.page)||1),v=E(()=>Number(t.query.limit)||25);return ye(t,f=>{const{query:o}=f;c(String(o.q||""),i.value||1,v.value||25,decodeURIComponent(String(o.facets||"")))},{immediate:!0}),(f,o)=>{var $,O,N,Y,G;const h=pe,_=fe,m=Le;return g(),y("div",null,[w(_,null,{default:S(()=>[w(h,null,{default:S(()=>[C("Browse Editions")]),_:1})]),_:1}),d("div",nt,[ne(d("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=b=>le(s)?s.value=b:s=b),onInput:o[1]||(o[1]=b=>f.$router.replace({query:{...a(t).query,q:a(s),page:1}})),class:"mx-auto my-4 h-16 min-w-full rounded border p-4 shadow",placeholder:"Search..."},null,544),[[be,a(s)]])]),d("div",null,[d("div",lt,[w(a(Ze),{as:"div",class:"flex flex-col pt-10",defaultOpen:""},{default:S(({open:b})=>[w(a(et),{class:"flex items-center justify-end gap-2 rounded align-top text-xl transition hover:bg-slate-200 active:bg-slate-300 lg:justify-center"},{default:S(()=>[C(k(b?"Hide":"Show")+" Filters... ",1),w(a(F),{class:"h-5 w-5 rotate-180 ui-open:rotate-0"})]),_:2},1024),w(a(tt),{as:"div",class:"flex flex-col gap-2 divide-y"},{default:S(()=>{var D,B;return[a(n)?M("",!0):(g(!0),y(I,{key:0},z((B=(D=a(l))==null?void 0:D.facet_counts)==null?void 0:B.sort((P,R)=>a(u)[R.field_name].length-a(u)[P.field_name].length),P=>(g(),H(m,{class:"pt-2","field-name":P.field_name,facets:P.counts,selected:a(u)[P.field_name],onFacetChange:R=>{a(u)[P.field_name]=R,f.$router.push({query:{...a(t).query,facets:p(a(u),!0),page:1}})}},null,8,["field-name","facets","selected","onFacetChange"]))),256))]}),_:1})]),_:1}),a(n)?(g(),H(je,{key:0,class:"-z-10"},{default:S(()=>[w(a(ke),{class:"h-5 w-5 animate-spin"})]),_:1})):(g(),y("div",st,[d("div",at,[d("button",{class:Z(["rounded border p-4 transition",a(i)<=1?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(i)<=1,onClick:o[2]||(o[2]=b=>f.$router.push({query:{...a(t).query,page:a(i)-1}}))},[rt,w(a(F),{class:"h-4 w-4 -rotate-90"})],10,ot),d("span",null," showing "+k((a(i)-1)*a(v)+1)+" - "+k(Math.min((($=a(l))==null?void 0:$.found)||1/0,a(i)*a(v)))+" out of "+k((O=a(l))==null?void 0:O.found),1),d("button",{class:Z(["rounded border p-4 transition",a(i)*a(v)>=Number((N=a(l))==null?void 0:N.found)?"cursor-not-allowed text-gray-400":"cursor-pointer hover:bg-slate-200 active:bg-slate-300"]),disabled:a(i)*a(v)>=Number((Y=a(l))==null?void 0:Y.found),onClick:o[3]||(o[3]=b=>f.$router.push({query:{...a(t).query,page:a(i)+1}}))},[ut,w(a(F),{class:"h-4 w-4 rotate-90"})],10,it)]),a(n)?M("",!0):(g(),y("div",ct,[dt,pt,ft,vt,(g(!0),y(I,null,z((G=a(l))==null?void 0:G.hits,b=>(g(),y(I,null,[mt,d("div",gt,[w(Re,{href:"/editions/"+b.document.id},{default:S(()=>{var D,B;return[(D=b.highlight["edition-name"])!=null&&D.snippet?(g(),y("span",{key:0,innerHTML:(B=b.highlight["edition-name"])==null?void 0:B.snippet},null,8,ht)):(g(),y("span",_t,k(b.document["edition-name"]),1))]}),_:2},1032,["href"])]),d("div",yt,k(b.document["institution-s"].map(D=>D["institution-name"]).join(", ")),1),d("div",bt,[w(Se,{href:b.document.url,"icon-only":""},null,8,["href"])]),d("div",wt,k(b.document["time-century"]),1)],64))),256))]))]))])])])}}});export{Ct as default};
